MAPPING/0/TRANSFORMATION/0/TRANSFORMFIELD/0/_DATATYPE,MAPPING/0/TRANSFORMATION/0/TRANSFORMFIELD/0/_DEFAULTVALUE,MAPPING/0/TRANSFORMATION/0/TRANSFORMFIELD/0/_DESCRIPTION,MAPPING/0/TRANSFORMATION/0/TRANSFORMFIELD/0/_NAME,MAPPING/0/TRANSFORMATION/0/TRANSFORMFIELD/0/_PICTURETEXT,MAPPING/0/TRANSFORMATION/0/TRANSFORMFIELD/0/_PORTTYPE,MAPPING/0/TRANSFORMATION/0/TRANSFORMFIELD/0/_PRECISION,MAPPING/0/TRANSFORMATION/0/TRANSFORMFIELD/0/_SCALE,MAPPING/0/TRANSFORMATION/0/TABLEATTRIBUTE/0/_NAME,MAPPING/0/TRANSFORMATION/0/TABLEATTRIBUTE/0/_VALUE,MAPPING/0/TRANSFORMATION/0/_DESCRIPTION,MAPPING/0/TRANSFORMATION/0/_NAME,MAPPING/0/TRANSFORMATION/0/_OBJECTVERSION,MAPPING/0/TRANSFORMATION/0/_REUSABLE,MAPPING/0/TRANSFORMATION/0/_TYPE,MAPPING/0/TRANSFORMATION/0/_VERSIONNUMBER,MAPPING/0/TRANSFORMATION/1/TRANSFORMFIELD/0/_DATATYPE,MAPPING/0/TRANSFORMATION/1/TRANSFORMFIELD/0/_DEFAULTVALUE,MAPPING/0/TRANSFORMATION/1/TRANSFORMFIELD/0/_DESCRIPTION,MAPPING/0/TRANSFORMATION/1/TRANSFORMFIELD/0/_NAME,MAPPING/0/TRANSFORMATION/1/TRANSFORMFIELD/0/_PICTURETEXT,MAPPING/0/TRANSFORMATION/1/TRANSFORMFIELD/0/_PORTTYPE,MAPPING/0/TRANSFORMATION/1/TRANSFORMFIELD/0/_PRECISION,MAPPING/0/TRANSFORMATION/1/TRANSFORMFIELD/0/_SCALE,MAPPING/0/TRANSFORMATION/1/TABLEATTRIBUTE/0/_NAME,MAPPING/0/TRANSFORMATION/1/TABLEATTRIBUTE/0/_VALUE,MAPPING/0/TRANSFORMATION/1/METADATAEXTENSION/0/_COMPONENTVERSION,MAPPING/0/TRANSFORMATION/1/METADATAEXTENSION/0/_DATATYPE,MAPPING/0/TRANSFORMATION/1/METADATAEXTENSION/0/_DESCRIPTION,MAPPING/0/TRANSFORMATION/1/METADATAEXTENSION/0/_DOMAINNAME,MAPPING/0/TRANSFORMATION/1/METADATAEXTENSION/0/_ISCLIENTEDITABLE,MAPPING/0/TRANSFORMATION/1/METADATAEXTENSION/0/_ISCLIENTVISIBLE,MAPPING/0/TRANSFORMATION/1/METADATAEXTENSION/0/_ISREUSABLE,MAPPING/0/TRANSFORMATION/1/METADATAEXTENSION/0/_ISSHAREREAD,MAPPING/0/TRANSFORMATION/1/METADATAEXTENSION/0/_ISSHAREWRITE,MAPPING/0/TRANSFORMATION/1/METADATAEXTENSION/0/_MAXLENGTH,MAPPING/0/TRANSFORMATION/1/METADATAEXTENSION/0/_NAME,MAPPING/0/TRANSFORMATION/1/METADATAEXTENSION/0/_VALUE,MAPPING/0/TRANSFORMATION/1/METADATAEXTENSION/0/_VENDORNAME,MAPPING/0/INSTANCE/0/_DESCRIPTION,MAPPING/0/INSTANCE/0/_NAME,MAPPING/0/INSTANCE/0/_TRANSFORMATION_NAME,MAPPING/0/INSTANCE/0/_TRANSFORMATION_TYPE,MAPPING/0/INSTANCE/0/_TYPE,MAPPING/0/INSTANCE/2/ASSOCIATED_SOURCE_INSTANCE/0/_NAME,MAPPING/0/CONNECTOR/0/_FROMFIELD,MAPPING/0/CONNECTOR/0/_FROMINSTANCE,MAPPING/0/CONNECTOR/0/_FROMINSTANCETYPE,MAPPING/0/CONNECTOR/0/_TOFIELD,MAPPING/0/CONNECTOR/0/_TOINSTANCE,MAPPING/0/CONNECTOR/0/_TOINSTANCETYPE,MAPPING/0/TARGETLOADORDER/0/_ORDER,MAPPING/0/TARGETLOADORDER/0/_TARGETINSTANCE,MAPPING/0/ERPINFO,MAPPING/0/_DESCRIPTION,MAPPING/0/_ISVALID,MAPPING/0/_NAME,MAPPING/0/_OBJECTVERSION,MAPPING/0/_VERSIONNUMBER,MAPPING/1/TRANSFORMATION/0/TRANSFORMFIELD/0/_DATATYPE,MAPPING/1/TRANSFORMATION/0/TRANSFORMFIELD/0/_DEFAULTVALUE,MAPPING/1/TRANSFORMATION/0/TRANSFORMFIELD/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/0/TRANSFORMFIELD/0/_NAME,MAPPING/1/TRANSFORMATION/0/TRANSFORMFIELD/0/_PICTURETEXT,MAPPING/1/TRANSFORMATION/0/TRANSFORMFIELD/0/_PORTTYPE,MAPPING/1/TRANSFORMATION/0/TRANSFORMFIELD/0/_PRECISION,MAPPING/1/TRANSFORMATION/0/TRANSFORMFIELD/0/_SCALE,MAPPING/1/TRANSFORMATION/0/TABLEATTRIBUTE/0/_NAME,MAPPING/1/TRANSFORMATION/0/TABLEATTRIBUTE/0/_VALUE,MAPPING/1/TRANSFORMATION/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/0/_NAME,MAPPING/1/TRANSFORMATION/0/_OBJECTVERSION,MAPPING/1/TRANSFORMATION/0/_REUSABLE,MAPPING/1/TRANSFORMATION/0/_TYPE,MAPPING/1/TRANSFORMATION/0/_VERSIONNUMBER,MAPPING/1/TRANSFORMATION/1/TRANSFORMFIELD/0/_DATATYPE,MAPPING/1/TRANSFORMATION/1/TRANSFORMFIELD/0/_DEFAULTVALUE,MAPPING/1/TRANSFORMATION/1/TRANSFORMFIELD/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/1/TRANSFORMFIELD/0/_NAME,MAPPING/1/TRANSFORMATION/1/TRANSFORMFIELD/0/_PICTURETEXT,MAPPING/1/TRANSFORMATION/1/TRANSFORMFIELD/0/_PORTTYPE,MAPPING/1/TRANSFORMATION/1/TRANSFORMFIELD/0/_PRECISION,MAPPING/1/TRANSFORMATION/1/TRANSFORMFIELD/0/_SCALE,MAPPING/1/TRANSFORMATION/1/TABLEATTRIBUTE/0/_NAME,MAPPING/1/TRANSFORMATION/1/TABLEATTRIBUTE/0/_VALUE,MAPPING/1/TRANSFORMATION/1/METADATAEXTENSION/0/_COMPONENTVERSION,MAPPING/1/TRANSFORMATION/1/METADATAEXTENSION/0/_DATATYPE,MAPPING/1/TRANSFORMATION/1/METADATAEXTENSION/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/1/METADATAEXTENSION/0/_DOMAINNAME,MAPPING/1/TRANSFORMATION/1/METADATAEXTENSION/0/_ISCLIENTEDITABLE,MAPPING/1/TRANSFORMATION/1/METADATAEXTENSION/0/_ISCLIENTVISIBLE,MAPPING/1/TRANSFORMATION/1/METADATAEXTENSION/0/_ISREUSABLE,MAPPING/1/TRANSFORMATION/1/METADATAEXTENSION/0/_ISSHAREREAD,MAPPING/1/TRANSFORMATION/1/METADATAEXTENSION/0/_ISSHAREWRITE,MAPPING/1/TRANSFORMATION/1/METADATAEXTENSION/0/_MAXLENGTH,MAPPING/1/TRANSFORMATION/1/METADATAEXTENSION/0/_NAME,MAPPING/1/TRANSFORMATION/1/METADATAEXTENSION/0/_VALUE,MAPPING/1/TRANSFORMATION/1/METADATAEXTENSION/0/_VENDORNAME,MAPPING/1/TRANSFORMATION/2/TRANSFORMFIELD/0/_DATATYPE,MAPPING/1/TRANSFORMATION/2/TRANSFORMFIELD/0/_DEFAULTVALUE,MAPPING/1/TRANSFORMATION/2/TRANSFORMFIELD/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/2/TRANSFORMFIELD/0/_NAME,MAPPING/1/TRANSFORMATION/2/TRANSFORMFIELD/0/_PICTURETEXT,MAPPING/1/TRANSFORMATION/2/TRANSFORMFIELD/0/_PORTTYPE,MAPPING/1/TRANSFORMATION/2/TRANSFORMFIELD/0/_PRECISION,MAPPING/1/TRANSFORMATION/2/TRANSFORMFIELD/0/_SCALE,MAPPING/1/TRANSFORMATION/2/TABLEATTRIBUTE/0/_NAME,MAPPING/1/TRANSFORMATION/2/TABLEATTRIBUTE/0/_VALUE,MAPPING/1/TRANSFORMATION/2/METADATAEXTENSION/0/_COMPONENTVERSION,MAPPING/1/TRANSFORMATION/2/METADATAEXTENSION/0/_DATATYPE,MAPPING/1/TRANSFORMATION/2/METADATAEXTENSION/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/2/METADATAEXTENSION/0/_DOMAINNAME,MAPPING/1/TRANSFORMATION/2/METADATAEXTENSION/0/_ISCLIENTEDITABLE,MAPPING/1/TRANSFORMATION/2/METADATAEXTENSION/0/_ISCLIENTVISIBLE,MAPPING/1/TRANSFORMATION/2/METADATAEXTENSION/0/_ISREUSABLE,MAPPING/1/TRANSFORMATION/2/METADATAEXTENSION/0/_ISSHAREREAD,MAPPING/1/TRANSFORMATION/2/METADATAEXTENSION/0/_ISSHAREWRITE,MAPPING/1/TRANSFORMATION/2/METADATAEXTENSION/0/_MAXLENGTH,MAPPING/1/TRANSFORMATION/2/METADATAEXTENSION/0/_NAME,MAPPING/1/TRANSFORMATION/2/METADATAEXTENSION/0/_VALUE,MAPPING/1/TRANSFORMATION/2/METADATAEXTENSION/0/_VENDORNAME,MAPPING/1/TRANSFORMATION/3/TRANSFORMFIELD/0/_DATATYPE,MAPPING/1/TRANSFORMATION/3/TRANSFORMFIELD/0/_DEFAULTVALUE,MAPPING/1/TRANSFORMATION/3/TRANSFORMFIELD/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/3/TRANSFORMFIELD/0/_NAME,MAPPING/1/TRANSFORMATION/3/TRANSFORMFIELD/0/_PICTURETEXT,MAPPING/1/TRANSFORMATION/3/TRANSFORMFIELD/0/_PORTTYPE,MAPPING/1/TRANSFORMATION/3/TRANSFORMFIELD/0/_PRECISION,MAPPING/1/TRANSFORMATION/3/TRANSFORMFIELD/0/_SCALE,MAPPING/1/TRANSFORMATION/3/TABLEATTRIBUTE/0/_NAME,MAPPING/1/TRANSFORMATION/3/TABLEATTRIBUTE/0/_VALUE,MAPPING/1/TRANSFORMATION/3/METADATAEXTENSION/0/_COMPONENTVERSION,MAPPING/1/TRANSFORMATION/3/METADATAEXTENSION/0/_DATATYPE,MAPPING/1/TRANSFORMATION/3/METADATAEXTENSION/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/3/METADATAEXTENSION/0/_DOMAINNAME,MAPPING/1/TRANSFORMATION/3/METADATAEXTENSION/0/_ISCLIENTEDITABLE,MAPPING/1/TRANSFORMATION/3/METADATAEXTENSION/0/_ISCLIENTVISIBLE,MAPPING/1/TRANSFORMATION/3/METADATAEXTENSION/0/_ISREUSABLE,MAPPING/1/TRANSFORMATION/3/METADATAEXTENSION/0/_ISSHAREREAD,MAPPING/1/TRANSFORMATION/3/METADATAEXTENSION/0/_ISSHAREWRITE,MAPPING/1/TRANSFORMATION/3/METADATAEXTENSION/0/_MAXLENGTH,MAPPING/1/TRANSFORMATION/3/METADATAEXTENSION/0/_NAME,MAPPING/1/TRANSFORMATION/3/METADATAEXTENSION/0/_VALUE,MAPPING/1/TRANSFORMATION/3/METADATAEXTENSION/0/_VENDORNAME,MAPPING/1/TRANSFORMATION/4/TRANSFORMFIELD/0/_DATATYPE,MAPPING/1/TRANSFORMATION/4/TRANSFORMFIELD/0/_DEFAULTVALUE,MAPPING/1/TRANSFORMATION/4/TRANSFORMFIELD/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/4/TRANSFORMFIELD/0/_EXPRESSION,MAPPING/1/TRANSFORMATION/4/TRANSFORMFIELD/0/_EXPRESSIONTYPE,MAPPING/1/TRANSFORMATION/4/TRANSFORMFIELD/0/_NAME,MAPPING/1/TRANSFORMATION/4/TRANSFORMFIELD/0/_PICTURETEXT,MAPPING/1/TRANSFORMATION/4/TRANSFORMFIELD/0/_PORTTYPE,MAPPING/1/TRANSFORMATION/4/TRANSFORMFIELD/0/_PRECISION,MAPPING/1/TRANSFORMATION/4/TRANSFORMFIELD/0/_SCALE,MAPPING/1/TRANSFORMATION/4/TABLEATTRIBUTE/0/_NAME,MAPPING/1/TRANSFORMATION/4/TABLEATTRIBUTE/0/_VALUE,MAPPING/1/TRANSFORMATION/5/TRANSFORMFIELD/0/_DATATYPE,MAPPING/1/TRANSFORMATION/5/TRANSFORMFIELD/0/_DEFAULTVALUE,MAPPING/1/TRANSFORMATION/5/TRANSFORMFIELD/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/5/TRANSFORMFIELD/0/_EXPRESSION,MAPPING/1/TRANSFORMATION/5/TRANSFORMFIELD/0/_EXPRESSIONTYPE,MAPPING/1/TRANSFORMATION/5/TRANSFORMFIELD/0/_NAME,MAPPING/1/TRANSFORMATION/5/TRANSFORMFIELD/0/_PICTURETEXT,MAPPING/1/TRANSFORMATION/5/TRANSFORMFIELD/0/_PORTTYPE,MAPPING/1/TRANSFORMATION/5/TRANSFORMFIELD/0/_PRECISION,MAPPING/1/TRANSFORMATION/5/TRANSFORMFIELD/0/_SCALE,MAPPING/1/TRANSFORMATION/5/TABLEATTRIBUTE/0/_NAME,MAPPING/1/TRANSFORMATION/5/TABLEATTRIBUTE/0/_VALUE,MAPPING/1/TRANSFORMATION/6/TRANSFORMFIELD/0/_DATATYPE,MAPPING/1/TRANSFORMATION/6/TRANSFORMFIELD/0/_DEFAULTVALUE,MAPPING/1/TRANSFORMATION/6/TRANSFORMFIELD/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/6/TRANSFORMFIELD/0/_EXPRESSION,MAPPING/1/TRANSFORMATION/6/TRANSFORMFIELD/0/_EXPRESSIONTYPE,MAPPING/1/TRANSFORMATION/6/TRANSFORMFIELD/0/_NAME,MAPPING/1/TRANSFORMATION/6/TRANSFORMFIELD/0/_PICTURETEXT,MAPPING/1/TRANSFORMATION/6/TRANSFORMFIELD/0/_PORTTYPE,MAPPING/1/TRANSFORMATION/6/TRANSFORMFIELD/0/_PRECISION,MAPPING/1/TRANSFORMATION/6/TRANSFORMFIELD/0/_SCALE,MAPPING/1/TRANSFORMATION/6/TABLEATTRIBUTE/0/_NAME,MAPPING/1/TRANSFORMATION/6/TABLEATTRIBUTE/0/_VALUE,MAPPING/1/TRANSFORMATION/7/TRANSFORMFIELD/0/_DATATYPE,MAPPING/1/TRANSFORMATION/7/TRANSFORMFIELD/0/_DEFAULTVALUE,MAPPING/1/TRANSFORMATION/7/TRANSFORMFIELD/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/7/TRANSFORMFIELD/0/_NAME,MAPPING/1/TRANSFORMATION/7/TRANSFORMFIELD/0/_PICTURETEXT,MAPPING/1/TRANSFORMATION/7/TRANSFORMFIELD/0/_PORTTYPE,MAPPING/1/TRANSFORMATION/7/TRANSFORMFIELD/0/_PRECISION,MAPPING/1/TRANSFORMATION/7/TRANSFORMFIELD/0/_SCALE,MAPPING/1/TRANSFORMATION/7/TABLEATTRIBUTE/0/_NAME,MAPPING/1/TRANSFORMATION/7/TABLEATTRIBUTE/0/_VALUE,MAPPING/1/TRANSFORMATION/7/METADATAEXTENSION/0/_COMPONENTVERSION,MAPPING/1/TRANSFORMATION/7/METADATAEXTENSION/0/_DATATYPE,MAPPING/1/TRANSFORMATION/7/METADATAEXTENSION/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/7/METADATAEXTENSION/0/_DOMAINNAME,MAPPING/1/TRANSFORMATION/7/METADATAEXTENSION/0/_ISCLIENTEDITABLE,MAPPING/1/TRANSFORMATION/7/METADATAEXTENSION/0/_ISCLIENTVISIBLE,MAPPING/1/TRANSFORMATION/7/METADATAEXTENSION/0/_ISREUSABLE,MAPPING/1/TRANSFORMATION/7/METADATAEXTENSION/0/_ISSHAREREAD,MAPPING/1/TRANSFORMATION/7/METADATAEXTENSION/0/_ISSHAREWRITE,MAPPING/1/TRANSFORMATION/7/METADATAEXTENSION/0/_MAXLENGTH,MAPPING/1/TRANSFORMATION/7/METADATAEXTENSION/0/_NAME,MAPPING/1/TRANSFORMATION/7/METADATAEXTENSION/0/_VALUE,MAPPING/1/TRANSFORMATION/7/METADATAEXTENSION/0/_VENDORNAME,MAPPING/1/TRANSFORMATION/8/TRANSFORMFIELD/0/_DATATYPE,MAPPING/1/TRANSFORMATION/8/TRANSFORMFIELD/0/_DEFAULTVALUE,MAPPING/1/TRANSFORMATION/8/TRANSFORMFIELD/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/8/TRANSFORMFIELD/0/_EXPRESSION,MAPPING/1/TRANSFORMATION/8/TRANSFORMFIELD/0/_EXPRESSIONTYPE,MAPPING/1/TRANSFORMATION/8/TRANSFORMFIELD/0/_NAME,MAPPING/1/TRANSFORMATION/8/TRANSFORMFIELD/0/_PICTURETEXT,MAPPING/1/TRANSFORMATION/8/TRANSFORMFIELD/0/_PORTTYPE,MAPPING/1/TRANSFORMATION/8/TRANSFORMFIELD/0/_PRECISION,MAPPING/1/TRANSFORMATION/8/TRANSFORMFIELD/0/_SCALE,MAPPING/1/TRANSFORMATION/8/TABLEATTRIBUTE/0/_NAME,MAPPING/1/TRANSFORMATION/8/TABLEATTRIBUTE/0/_VALUE,MAPPING/1/TRANSFORMATION/9/TRANSFORMFIELD/0/_DATATYPE,MAPPING/1/TRANSFORMATION/9/TRANSFORMFIELD/0/_DEFAULTVALUE,MAPPING/1/TRANSFORMATION/9/TRANSFORMFIELD/0/_DESCRIPTION,MAPPING/1/TRANSFORMATION/9/TRANSFORMFIELD/0/_NAME,MAPPING/1/TRANSFORMATION/9/TRANSFORMFIELD/0/_PICTURETEXT,MAPPING/1/TRANSFORMATION/9/TRANSFORMFIELD/0/_PORTTYPE,MAPPING/1/TRANSFORMATION/9/TRANSFORMFIELD/0/_PRECISION,MAPPING/1/TRANSFORMATION/9/TRANSFORMFIELD/0/_SCALE,MAPPING/1/TRANSFORMATION/9/TABLEATTRIBUTE/0/_NAME,MAPPING/1/TRANSFORMATION/9/TABLEATTRIBUTE/0/_VALUE,MAPPING/1/INSTANCE/0/_DESCRIPTION,MAPPING/1/INSTANCE/0/_NAME,MAPPING/1/INSTANCE/0/_TRANSFORMATION_NAME,MAPPING/1/INSTANCE/0/_TRANSFORMATION_TYPE,MAPPING/1/INSTANCE/0/_TYPE,MAPPING/1/INSTANCE/5/ASSOCIATED_SOURCE_INSTANCE/0/_NAME,MAPPING/1/INSTANCE/6/ASSOCIATED_SOURCE_INSTANCE/0/_NAME,MAPPING/1/INSTANCE/7/ASSOCIATED_SOURCE_INSTANCE/0/_NAME,MAPPING/1/INSTANCE/17/ASSOCIATED_SOURCE_INSTANCE/0/_NAME,MAPPING/1/CONNECTOR/0/_FROMFIELD,MAPPING/1/CONNECTOR/0/_FROMINSTANCE,MAPPING/1/CONNECTOR/0/_FROMINSTANCETYPE,MAPPING/1/CONNECTOR/0/_TOFIELD,MAPPING/1/CONNECTOR/0/_TOINSTANCE,MAPPING/1/CONNECTOR/0/_TOINSTANCETYPE,MAPPING/1/TARGETLOADORDER/0/_ORDER,MAPPING/1/TARGETLOADORDER/0/_TARGETINSTANCE,MAPPING/1/MAPPINGVARIABLE/0/_DATATYPE,MAPPING/1/MAPPINGVARIABLE/0/_DEFAULTVALUE,MAPPING/1/MAPPINGVARIABLE/0/_DESCRIPTION,MAPPING/1/MAPPINGVARIABLE/0/_ISEXPRESSIONVARIABLE,MAPPING/1/MAPPINGVARIABLE/0/_ISPARAM,MAPPING/1/MAPPINGVARIABLE/0/_NAME,MAPPING/1/MAPPINGVARIABLE/0/_PRECISION,MAPPING/1/MAPPINGVARIABLE/0/_SCALE,MAPPING/1/MAPPINGVARIABLE/0/_USERDEFINED,SHORTCUT/0/_COMMENTS,SHORTCUT/0/_DBDNAME,SHORTCUT/0/_FOLDERNAME,SHORTCUT/0/_NAME,SHORTCUT/0/_OBJECTSUBTYPE,SHORTCUT/0/_OBJECTTYPE,SHORTCUT/0/_REFERENCEDDBD,SHORTCUT/0/_REFERENCETYPE,SHORTCUT/0/_REFOBJECTNAME,SHORTCUT/0/_REPOSITORYNAME,SHORTCUT/0/_VERSIONNUMBER,CONFIG/0/ATTRIBUTE/0/_NAME,CONFIG/0/ATTRIBUTE/0/_VALUE,CONFIG/0/_DESCRIPTION,CONFIG/0/_ISDEFAULT,CONFIG/0/_NAME,CONFIG/0/_VERSIONNUMBER,CONFIG/1/ATTRIBUTE/0/_NAME,CONFIG/1/ATTRIBUTE/0/_VALUE,SESSION/0/SESSTRANSFORMATIONINST/0/_ISREPARTITIONPOINT,SESSION/0/SESSTRANSFORMATIONINST/0/_PARTITIONTYPE,SESSION/0/SESSTRANSFORMATIONINST/0/_PIPELINE,SESSION/0/SESSTRANSFORMATIONINST/0/_SINSTANCENAME,SESSION/0/SESSTRANSFORMATIONINST/0/_STAGE,SESSION/0/SESSTRANSFORMATIONINST/0/_TRANSFORMATIONNAME,SESSION/0/SESSTRANSFORMATIONINST/0/_TRANSFORMATIONTYPE,SESSION/0/CONFIGREFERENCE/_REFOBJECTNAME,SESSION/0/CONFIGREFERENCE/_TYPE,SESSION/0/SESSIONEXTENSION/0/CONNECTIONREFERENCE/_CNXREFNAME,SESSION/0/SESSIONEXTENSION/0/CONNECTIONREFERENCE/_CONNECTIONNAME,SESSION/0/SESSIONEXTENSION/0/CONNECTIONREFERENCE/_CONNECTIONNUMBER,SESSION/0/SESSIONEXTENSION/0/CONNECTIONREFERENCE/_CONNECTIONSUBTYPE,SESSION/0/SESSIONEXTENSION/0/CONNECTIONREFERENCE/_CONNECTIONTYPE,SESSION/0/SESSIONEXTENSION/0/CONNECTIONREFERENCE/_VARIABLE,SESSION/0/SESSIONEXTENSION/0/ATTRIBUTE/0/_NAME,SESSION/0/SESSIONEXTENSION/0/ATTRIBUTE/0/_VALUE,SESSION/0/SESSIONEXTENSION/0/_NAME,SESSION/0/SESSIONEXTENSION/0/_SINSTANCENAME,SESSION/0/SESSIONEXTENSION/0/_SUBTYPE,SESSION/0/SESSIONEXTENSION/0/_TRANSFORMATIONTYPE,SESSION/0/SESSIONEXTENSION/0/_TYPE,SESSION/0/SESSIONEXTENSION/1/ATTRIBUTE/0/_NAME,SESSION/0/SESSIONEXTENSION/1/ATTRIBUTE/0/_VALUE,SESSION/0/ATTRIBUTE/0/_NAME,SESSION/0/ATTRIBUTE/0/_VALUE,SESSION/0/_DESCRIPTION,SESSION/0/_ISVALID,SESSION/0/_MAPPINGNAME,SESSION/0/_NAME,SESSION/0/_REUSABLE,SESSION/0/_SORTORDER,SESSION/0/_VERSIONNUMBER,SESSION/1/SESSTRANSFORMATIONINST/0/_ISREPARTITIONPOINT,SESSION/1/SESSTRANSFORMATIONINST/0/_PARTITIONTYPE,SESSION/1/SESSTRANSFORMATIONINST/0/_PIPELINE,SESSION/1/SESSTRANSFORMATIONINST/0/_SINSTANCENAME,SESSION/1/SESSTRANSFORMATIONINST/0/_STAGE,SESSION/1/SESSTRANSFORMATIONINST/0/_TRANSFORMATIONNAME,SESSION/1/SESSTRANSFORMATIONINST/0/_TRANSFORMATIONTYPE,SESSION/1/CONFIGREFERENCE/ATTRIBUTE/0/_NAME,SESSION/1/CONFIGREFERENCE/ATTRIBUTE/0/_VALUE,SESSION/1/SESSIONEXTENSION/0/CONNECTIONREFERENCE/_CNXREFNAME,SESSION/1/SESSIONEXTENSION/0/CONNECTIONREFERENCE/_CONNECTIONNAME,SESSION/1/SESSIONEXTENSION/0/CONNECTIONREFERENCE/_CONNECTIONNUMBER,SESSION/1/SESSIONEXTENSION/0/CONNECTIONREFERENCE/_CONNECTIONSUBTYPE,SESSION/1/SESSIONEXTENSION/0/CONNECTIONREFERENCE/_CONNECTIONTYPE,SESSION/1/SESSIONEXTENSION/0/CONNECTIONREFERENCE/_VARIABLE,SESSION/1/SESSIONEXTENSION/0/ATTRIBUTE/0/_NAME,SESSION/1/SESSIONEXTENSION/0/ATTRIBUTE/0/_VALUE,SESSION/1/SESSIONEXTENSION/0/_NAME,SESSION/1/SESSIONEXTENSION/0/_SINSTANCENAME,SESSION/1/SESSIONEXTENSION/0/_SUBTYPE,SESSION/1/SESSIONEXTENSION/0/_TRANSFORMATIONTYPE,SESSION/1/SESSIONEXTENSION/0/_TYPE,SESSION/1/SESSIONEXTENSION/3/ATTRIBUTE/0/_NAME,SESSION/1/SESSIONEXTENSION/3/ATTRIBUTE/0/_VALUE,SESSION/1/SESSIONEXTENSION/4/ATTRIBUTE/0/_NAME,SESSION/1/SESSIONEXTENSION/4/ATTRIBUTE/0/_VALUE,SESSION/1/SESSIONEXTENSION/5/ATTRIBUTE/0/_NAME,SESSION/1/SESSIONEXTENSION/5/ATTRIBUTE/0/_VALUE,SESSION/1/ATTRIBUTE/0/_NAME,SESSION/1/ATTRIBUTE/0/_VALUE,WORKFLOW/SCHEDULER/SCHEDULEINFO/STARTOPTIONS/_STARTDATE,WORKFLOW/SCHEDULER/SCHEDULEINFO/STARTOPTIONS/_STARTTIME,WORKFLOW/SCHEDULER/SCHEDULEINFO/SCHEDULEOPTIONS/CUSTOM/DAILYFREQUENCY/_RUNONCE,WORKFLOW/SCHEDULER/SCHEDULEINFO/SCHEDULEOPTIONS/CUSTOM/REPEAT/FILTER/0/_DAY,WORKFLOW/SCHEDULER/SCHEDULEINFO/SCHEDULEOPTIONS/CUSTOM/REPEAT/_INTERVAL,WORKFLOW/SCHEDULER/SCHEDULEINFO/SCHEDULEOPTIONS/CUSTOM/REPEAT/_TYPE,WORKFLOW/SCHEDULER/SCHEDULEINFO/SCHEDULEOPTIONS/_SCHEDULETYPE,WORKFLOW/SCHEDULER/SCHEDULEINFO/ENDOPTIONS/_ENDON,WORKFLOW/SCHEDULER/SCHEDULEINFO/ENDOPTIONS/_ENDTYPE,WORKFLOW/SCHEDULER/_DESCRIPTION,WORKFLOW/SCHEDULER/_NAME,WORKFLOW/SCHEDULER/_REUSABLE,WORKFLOW/SCHEDULER/_VERSIONNUMBER,WORKFLOW/TASK/0/ATTRIBUTE/0/_NAME,WORKFLOW/TASK/0/ATTRIBUTE/0/_VALUE,WORKFLOW/TASK/0/VALUEPAIR/0/_EXECORDER,WORKFLOW/TASK/0/VALUEPAIR/0/_NAME,WORKFLOW/TASK/0/VALUEPAIR/0/_REVERSEASSIGNMENT,WORKFLOW/TASK/0/VALUEPAIR/0/_VALUE,WORKFLOW/TASK/0/_DESCRIPTION,WORKFLOW/TASK/0/_NAME,WORKFLOW/TASK/0/_REUSABLE,WORKFLOW/TASK/0/_TYPE,WORKFLOW/TASK/0/_VERSIONNUMBER,WORKFLOW/TASK/2/ATTRIBUTE/0/_NAME,WORKFLOW/TASK/2/ATTRIBUTE/0/_VALUE,WORKFLOW/TASK/2/VALUEPAIR/0/_EXECORDER,WORKFLOW/TASK/2/VALUEPAIR/0/_NAME,WORKFLOW/TASK/2/VALUEPAIR/0/_REVERSEASSIGNMENT,WORKFLOW/TASK/2/VALUEPAIR/0/_VALUE,WORKFLOW/TASK/3/ATTRIBUTE/0/_NAME,WORKFLOW/TASK/3/ATTRIBUTE/0/_VALUE,WORKFLOW/TASK/3/VALUEPAIR/0/_EXECORDER,WORKFLOW/TASK/3/VALUEPAIR/0/_NAME,WORKFLOW/TASK/3/VALUEPAIR/0/_REVERSEASSIGNMENT,WORKFLOW/TASK/3/VALUEPAIR/0/_VALUE,WORKFLOW/TASK/4/ATTRIBUTE/0/_NAME,WORKFLOW/TASK/4/ATTRIBUTE/0/_VALUE,WORKFLOW/TASK/4/VALUEPAIR/0/_EXECORDER,WORKFLOW/TASK/4/VALUEPAIR/0/_NAME,WORKFLOW/TASK/4/VALUEPAIR/0/_REVERSEASSIGNMENT,WORKFLOW/TASK/4/VALUEPAIR/0/_VALUE,WORKFLOW/TASK/5/ATTRIBUTE/0/_NAME,WORKFLOW/TASK/5/ATTRIBUTE/0/_VALUE,WORKFLOW/TASK/5/VALUEPAIR/0/_EXECORDER,WORKFLOW/TASK/5/VALUEPAIR/0/_NAME,WORKFLOW/TASK/5/VALUEPAIR/0/_REVERSEASSIGNMENT,WORKFLOW/TASK/5/VALUEPAIR/0/_VALUE,WORKFLOW/TASK/6/ATTRIBUTE/0/_NAME,WORKFLOW/TASK/6/ATTRIBUTE/0/_VALUE,WORKFLOW/TASK/6/VALUEPAIR/0/_EXECORDER,WORKFLOW/TASK/6/VALUEPAIR/0/_NAME,WORKFLOW/TASK/6/VALUEPAIR/0/_REVERSEASSIGNMENT,WORKFLOW/TASK/6/VALUEPAIR/0/_VALUE,WORKFLOW/TASKINSTANCE/0/_DESCRIPTION,WORKFLOW/TASKINSTANCE/0/_FAIL_PARENT_IF_INSTANCE_DID_NOT_RUN,WORKFLOW/TASKINSTANCE/0/_FAIL_PARENT_IF_INSTANCE_FAILS,WORKFLOW/TASKINSTANCE/0/_ISENABLED,WORKFLOW/TASKINSTANCE/0/_NAME,WORKFLOW/TASKINSTANCE/0/_REUSABLE,WORKFLOW/TASKINSTANCE/0/_TASKNAME,WORKFLOW/TASKINSTANCE/0/_TASKTYPE,WORKFLOW/TASKINSTANCE/0/_TREAT_INPUTLINK_AS_AND,WORKFLOW/WORKFLOWLINK/0/_CONDITION,WORKFLOW/WORKFLOWLINK/0/_FROMTASK,WORKFLOW/WORKFLOWLINK/0/_TOTASK,WORKFLOW/WORKFLOWVARIABLE/0/_DATATYPE,WORKFLOW/WORKFLOWVARIABLE/0/_DEFAULTVALUE,WORKFLOW/WORKFLOWVARIABLE/0/_DESCRIPTION,WORKFLOW/WORKFLOWVARIABLE/0/_ISNULL,WORKFLOW/WORKFLOWVARIABLE/0/_ISPERSISTENT,WORKFLOW/WORKFLOWVARIABLE/0/_NAME,WORKFLOW/WORKFLOWVARIABLE/0/_USERDEFINED,WORKFLOW/ATTRIBUTE/0/_NAME,WORKFLOW/ATTRIBUTE/0/_VALUE,WORKFLOW/_DESCRIPTION,WORKFLOW/_ISENABLED,WORKFLOW/_ISRUNNABLESERVICE,WORKFLOW/_ISSERVICE,WORKFLOW/_ISVALID,WORKFLOW/_NAME,WORKFLOW/_REUSABLE_SCHEDULER,WORKFLOW/_SCHEDULERNAME,WORKFLOW/_SERVERNAME,WORKFLOW/_SERVER_DOMAINNAME,WORKFLOW/_SUSPEND_ON_ERROR,WORKFLOW/_TASKS_MUST_RUN_ON_SERVER,WORKFLOW/_VERSIONNUMBER,_NAME,_GROUP,_OWNER,_SHARED,_DESCRIPTION,_PERMISSIONS,_UUID,SOURCE/0/SOURCEFIELD/0/_BUSINESSNAME,SOURCE/0/SOURCEFIELD/0/_DATATYPE,SOURCE/0/SOURCEFIELD/0/_DESCRIPTION,SOURCE/0/SOURCEFIELD/0/_FIELDNUMBER,SOURCE/0/SOURCEFIELD/0/_FIELDPROPERTY,SOURCE/0/SOURCEFIELD/0/_FIELDTYPE,SOURCE/0/SOURCEFIELD/0/_HIDDEN,SOURCE/0/SOURCEFIELD/0/_KEYTYPE,SOURCE/0/SOURCEFIELD/0/_LENGTH,SOURCE/0/SOURCEFIELD/0/_LEVEL,SOURCE/0/SOURCEFIELD/0/_NAME,SOURCE/0/SOURCEFIELD/0/_NULLABLE,SOURCE/0/SOURCEFIELD/0/_OCCURS,SOURCE/0/SOURCEFIELD/0/_OFFSET,SOURCE/0/SOURCEFIELD/0/_PHYSICALLENGTH,SOURCE/0/SOURCEFIELD/0/_PHYSICALOFFSET,SOURCE/0/SOURCEFIELD/0/_PICTURETEXT,SOURCE/0/SOURCEFIELD/0/_PRECISION,SOURCE/0/SOURCEFIELD/0/_SCALE,SOURCE/0/SOURCEFIELD/0/_USAGE_FLAGS,SOURCE/0/_BUSINESSNAME,SOURCE/0/_DATABASETYPE,SOURCE/0/_DBDNAME,SOURCE/0/_DESCRIPTION,SOURCE/0/_NAME,SOURCE/0/_OBJECTVERSION,SOURCE/0/_OWNERNAME,SOURCE/0/_VERSIONNUMBER,SOURCE/1/SOURCEFIELD/0/_BUSINESSNAME,SOURCE/1/SOURCEFIELD/0/_DATATYPE,SOURCE/1/SOURCEFIELD/0/_DESCRIPTION,SOURCE/1/SOURCEFIELD/0/_FIELDNUMBER,SOURCE/1/SOURCEFIELD/0/_FIELDPROPERTY,SOURCE/1/SOURCEFIELD/0/_FIELDTYPE,SOURCE/1/SOURCEFIELD/0/_HIDDEN,SOURCE/1/SOURCEFIELD/0/_KEYTYPE,SOURCE/1/SOURCEFIELD/0/_LENGTH,SOURCE/1/SOURCEFIELD/0/_LEVEL,SOURCE/1/SOURCEFIELD/0/_NAME,SOURCE/1/SOURCEFIELD/0/_NULLABLE,SOURCE/1/SOURCEFIELD/0/_OCCURS,SOURCE/1/SOURCEFIELD/0/_OFFSET,SOURCE/1/SOURCEFIELD/0/_PHYSICALLENGTH,SOURCE/1/SOURCEFIELD/0/_PHYSICALOFFSET,SOURCE/1/SOURCEFIELD/0/_PICTURETEXT,SOURCE/1/SOURCEFIELD/0/_PRECISION,SOURCE/1/SOURCEFIELD/0/_SCALE,SOURCE/1/SOURCEFIELD/0/_USAGE_FLAGS,SOURCE/2/TABLEATTRIBUTE/0/_NAME,SOURCE/2/TABLEATTRIBUTE/0/_VALUE,SOURCE/2/SOURCEFIELD/0/_BUSINESSNAME,SOURCE/2/SOURCEFIELD/0/_DATATYPE,SOURCE/2/SOURCEFIELD/0/_DESCRIPTION,SOURCE/2/SOURCEFIELD/0/_FIELDNUMBER,SOURCE/2/SOURCEFIELD/0/_FIELDPROPERTY,SOURCE/2/SOURCEFIELD/0/_FIELDTYPE,SOURCE/2/SOURCEFIELD/0/_HIDDEN,SOURCE/2/SOURCEFIELD/0/_KEYTYPE,SOURCE/2/SOURCEFIELD/0/_LENGTH,SOURCE/2/SOURCEFIELD/0/_LEVEL,SOURCE/2/SOURCEFIELD/0/_NAME,SOURCE/2/SOURCEFIELD/0/_NULLABLE,SOURCE/2/SOURCEFIELD/0/_OCCURS,SOURCE/2/SOURCEFIELD/0/_OFFSET,SOURCE/2/SOURCEFIELD/0/_PHYSICALLENGTH,SOURCE/2/SOURCEFIELD/0/_PHYSICALOFFSET,SOURCE/2/SOURCEFIELD/0/_PICTURETEXT,SOURCE/2/SOURCEFIELD/0/_PRECISION,SOURCE/2/SOURCEFIELD/0/_SCALE,SOURCE/2/SOURCEFIELD/0/_USAGE_FLAGS,SOURCE/2/METADATAEXTENSION/0/_DATATYPE,SOURCE/2/METADATAEXTENSION/0/_DESCRIPTION,SOURCE/2/METADATAEXTENSION/0/_DOMAINNAME,SOURCE/2/METADATAEXTENSION/0/_ISCLIENTEDITABLE,SOURCE/2/METADATAEXTENSION/0/_ISCLIENTVISIBLE,SOURCE/2/METADATAEXTENSION/0/_ISREUSABLE,SOURCE/2/METADATAEXTENSION/0/_ISSHAREREAD,SOURCE/2/METADATAEXTENSION/0/_ISSHAREWRITE,SOURCE/2/METADATAEXTENSION/0/_MAXLENGTH,SOURCE/2/METADATAEXTENSION/0/_NAME,SOURCE/2/METADATAEXTENSION/0/_VALUE,SOURCE/2/METADATAEXTENSION/0/_VENDORNAME,TARGET/0/TARGETFIELD/0/_BUSINESSNAME,TARGET/0/TARGETFIELD/0/_DATATYPE,TARGET/0/TARGETFIELD/0/_DESCRIPTION,TARGET/0/TARGETFIELD/0/_FIELDNUMBER,TARGET/0/TARGETFIELD/0/_KEYTYPE,TARGET/0/TARGETFIELD/0/_NAME,TARGET/0/TARGETFIELD/0/_NULLABLE,TARGET/0/TARGETFIELD/0/_PICTURETEXT,TARGET/0/TARGETFIELD/0/_PRECISION,TARGET/0/TARGETFIELD/0/_SCALE,TARGET/0/_BUSINESSNAME,TARGET/0/_CONSTRAINT,TARGET/0/_DATABASETYPE,TARGET/0/_DESCRIPTION,TARGET/0/_NAME,TARGET/0/_OBJECTVERSION,TARGET/0/_TABLEOPTIONS,TARGET/0/_VERSIONNUMBER,TARGET/1/TARGETFIELD/0/_BUSINESSNAME,TARGET/1/TARGETFIELD/0/_DATATYPE,TARGET/1/TARGETFIELD/0/_DESCRIPTION,TARGET/1/TARGETFIELD/0/_FIELDNUMBER,TARGET/1/TARGETFIELD/0/_KEYTYPE,TARGET/1/TARGETFIELD/0/_NAME,TARGET/1/TARGETFIELD/0/_NULLABLE,TARGET/1/TARGETFIELD/0/_PICTURETEXT,TARGET/1/TARGETFIELD/0/_PRECISION,TARGET/1/TARGETFIELD/0/_SCALE
string,,,IN_OUTPUT_RUNDATE,,INPUT,10,0,Tracing Level,Normal,Created by:Saurabh Jain Created Date:  Description:Expression for setting up date format,exp_cntry_multi_def_cd,1,NO,Expression,2,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,Created by:Saurabh Jain Created Date:  Description:Stage level Target,CNTRY_MULTI_DEF_CD_S,CNTRY_MULTI_DEF_CD_S,Target Definition,TARGET,cntry_multi_def_cd_daily,OUT_DW_LOAD_TS,exp_cntry_multi_def_cd,Expression,DW_LOAD_TS,CNTRY_MULTI_DEF_CD_S,Target Definition,1,CNTRY_MULTI_DEF_CD_S,,,YES,m_src_stg_cntry_multi_def_cd,1,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,string,,,NO,YES,$$STG_SCHEMA,251,0,YES,,Flat_File,IDW_SHARE,cntry_multi_def_cd_daily,Source Definition,SOURCE,Flat_File,LOCAL,cntry_multi_def_cd_daily,PCRS_SCHWAB_MIG,2,Advanced,,,NO,IDW_STG_SessionConfig,6,Advanced,,YES,PASS THROUGH,1,CNTRY_MULTI_DEF_CD_S,1,CNTRY_MULTI_DEF_CD_S,Target Definition,IDW_STG_SessionConfig,Session config,DB Connection,,1,,Relational,$DBConnection_Target,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_S,Relational Writer,Target Definition,WRITER,Input Type,File,General Options,,src to stage session for m_src_stg_cntry_multi_def_cd,YES,m_src_stg_cntry_multi_def_cd,s_src_stg_cntry_multi_def_cd,YES,Binary,2,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,Stop on errors,1,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,MONDAY,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,Fail task if any command fails,YES,1,cmd_create_index,NO,ksh $IDW_CMD/idw_idw_postsession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,,t_postsession_idw_cntry_multi_def_cd,NO,Command,2,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,YES,YES,YES,t_postsession_idw_cntry_multi_def_cd,NO,t_postsession_idw_cntry_multi_def_cd,Command,YES,$s_stg_idw_cntry_multi_def_cd.ErrorCode = 0,s_stg_idw_cntry_multi_def_cd,t_postsession_idw_cntry_multi_def_cd,date/time,,The time this task started,NO,NO,$t_postsession_idw_cntry_multi_def_cd.StartTime,NO,Parameter Filename,/opt/idw/pr/common/prm/IDW_Code_Tables_wf_src_idw_cntry_multi_def_cd.prm,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_DW_AS_OF_DT,,OUTPUT,29,9,User Defined Join,,Created by:Saurabh Jain Created Date:  Description:Source to Stage level data loading,SQ_cntry_multi_def_cd_daily,1,NO,Source Qualifier,2,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description:Expression for setting up date format,exp_cntry_multi_def_cd,exp_cntry_multi_def_cd,Expression,TRANSFORMATION,CNTRY_MULTI_DEF_CD_T_UPD_DEL,OUT_DW_AS_OF_DT,exp_cntry_multi_def_cd,Expression,DW_AS_OF_DT,CNTRY_MULTI_DEF_CD_S,Target Definition,1,CNTRY_MULTI_DEF_CD_T_UPD_DEL,,,YES,m_stg_idw_cntry_multi_def_cd,1,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,"TO_DATE (IN_OUTPUT_RUNDATE ,'YYYY-MM-DD')",GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,string,,,NO,YES,$$IDW_SCHEMA,2510,0,YES,,IDW_ETL_LOAD_STG,IDW_SHARE,CNTRY_MULTI_DEF_CD_S,Target Definition,TARGET,IDW_ETL_LOAD_STG,LOCAL,CNTRY_MULTI_DEF_CD_S,PCRS_SCHWAB_MIG,2,Constraint based load ordering,NO,,NO,IDW_SessionConfig,7,Advanced,,NO,PASS THROUGH,0,cntry_multi_def_cd_daily,0,cntry_multi_def_cd_daily,Source Definition,IDW_SessionConfig,Session config,Connection,,1,,,,Insert,YES,File Reader,cntry_multi_def_cd_daily,File Reader,Source Definition,READER,Input Type,File,Write Backward Compatible Session Log File,NO,,YES,m_stg_idw_cntry_multi_def_cd,s_stg_idw_cntry_multi_def_cd,YES,Binary,2,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,TUESDAY,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,Recovery Strategy,Restart task,2,CMD_IDW_LOAD_STATUS,NO,ksh $IDW_CMD/idw_load_status.ksh cntry_multi_def_cd_t $$Input_File_Name F wf_src_idw_cntry_multi_def_cd 'In Process'>> $$Log_File_Name,,Start,NO,Start,2,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,YES,YES,YES,Start,NO,Start,Start,YES,$t_presession_idw_cntry_multi_def_cd.ErrorCode = 0,t_presession_idw_cntry_multi_def_cd,s_stg_idw_cntry_multi_def_cd,date/time,,The time this task completed,NO,NO,$t_postsession_idw_cntry_multi_def_cd.EndTime,NO,Write Backward Compatible Workflow Log File,NO,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,IN_AUDIT_UPDT_TS,,INPUT,19,0,Source Filter,,Created by:Saurabh Jain Created Date:  Description:Stage to Target level data loading,SQ_CNTRY_MULTI_DEF_CD_T_UPD_DEL,1,NO,Source Qualifier,2,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description:Source to Stage level data loading,SQ_cntry_multi_def_cd_daily,SQ_cntry_multi_def_cd_daily,Source Qualifier,TRANSFORMATION,CNTRY_MULTI_DEF_CD_S_UPD_CHG,CHANGE_IND,SQ_cntry_multi_def_cd_daily,Source Qualifier,DW_ACTN_IND,CNTRY_MULTI_DEF_CD_S,Target Definition,2,CNTRY_MULTI_DEF_CD_T_INS_DEL,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,"TO_DATE(IN_AUDIT_UPDT_TS,'YYYY-MM-DD HH24.MI.SS')",GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,IDW_ETL_LOAD_IDW,IDW_SHARE,CNTRY_MULTI_DEF_CD_S,Source Definition,SOURCE,IDW_ETL_LOAD_IDW,LOCAL,CNTRY_MULTI_DEF_CD_S,PCRS_SCHWAB_MIG,2,Cache LOOKUP() function,YES,,,,,Advanced,,YES,PASS THROUGH,1,SQ_cntry_multi_def_cd_daily,2,SQ_cntry_multi_def_cd_daily,Source Qualifier,,,DB Connection,,1,,Relational,$DBConnection_Source,Update as Update,NO,File Reader,SQ_cntry_multi_def_cd_daily,File Reader,Source Qualifier,READER,Input Type,File,Session Log File Name,$PMSessionLogFile,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,WEDNESDAY,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,Recovery Strategy,Restart task,2,cmd_idw_load_status,NO,ksh $IDW_CMD/idw_load_status.ksh cntry_multi_def_cd_t $$Input_File_Name_prev F wf_src_idw_cntry_multi_def_cd 'Completed',,t_presession_idw_cntry_multi_def_cd,NO,Command,2,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,YES,YES,YES,s_stg_idw_cntry_multi_def_cd,YES,s_stg_idw_cntry_multi_def_cd,Session,YES,$t_postsession_cntry_multi_def_cd.ErrorCode = 0,t_postsession_cntry_multi_def_cd,t_presession_idw_cntry_multi_def_cd,integer,,Status of this task's execution,NO,NO,$t_postsession_idw_cntry_multi_def_cd.Status,NO,Workflow Log File Name,$PMWorkflowName.log,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_AUDIT_UPDT_TS,,OUTPUT,29,9,Number Of Sorted Ports,0,Created by:Saurabh Jain Created Date:  Description:Stage to Target level data loading,SQ_CNTRY_MULTI_DEF_CD_T_UPD_CHG,1,NO,Source Qualifier,2,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description:Source to Stage level data loading,cntry_multi_def_cd_daily,cntry_multi_def_cd_daily,Source Definition,SOURCE,,SWB_CNTRY_ID,SQ_cntry_multi_def_cd_daily,Source Qualifier,SWB_CNTRY_ID,CNTRY_MULTI_DEF_CD_S,Target Definition,4,CNTRY_MULTI_DEF_CD_T_INS_NEW,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SESSSTARTTIME,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,IDW_SHARE,CNTRY_MULTI_DEF_CD_T,Source Definition,SOURCE,,LOCAL,CNTRY_MULTI_DEF_CD_T,PCRS_SCHWAB_MIG,2,Default buffer block size,Auto,,,,,Advanced,,NO,PASS THROUGH,1,exp_cntry_multi_def_cd,2,exp_cntry_multi_def_cd,Expression,,,DB Connection,,1,,Relational,$DBConnection_Target,Update as Insert,NO,Relational Reader,CNTRY_MULTI_DEF_CD_S_INS_NEW,Relational Reader,Source Definition,READER,Input Type,File,Session Log File directory,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,THURSDAY,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,Recovery Strategy,Restart task,,,,,,t_presession_stg_cntry_multi_def_cd,NO,Command,2,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,YES,YES,YES,t_presession_idw_cntry_multi_def_cd,NO,t_presession_idw_cntry_multi_def_cd,Command,NO,$t_preload_multi_def_cd.ErrorCode=0,t_preload_multi_def_cd,t_presession_stg_cntry_multi_def_cd,integer,,Status of the previous task that is not disabled,NO,NO,$t_postsession_idw_cntry_multi_def_cd.PrevTaskStatus,NO,Workflow Log File Directory,$PMWorkflowLogDir/$PMFolderName/,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_DW_LOAD_TS,,OUTPUT,29,9,Tracing Level,Normal,Created by:Saurabh Jain Created Date:  Description:Stage to Target level data loading,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,1,NO,Source Qualifier,2,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_DEL,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,,CNTRY_SCHEME_CD,SQ_cntry_multi_def_cd_daily,Source Qualifier,CNTRY_SCHEME_CD,CNTRY_MULTI_DEF_CD_S,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,CNTRY_SCHEME_CD,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,IDW_SHARE,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,,LOCAL,CNTRY_MULTI_DEF_CD_T,PCRS_SCHWAB_MIG,2,Line Sequential buffer length,1024,,,,,Advanced,,NO,PASS THROUGH,0,CNTRY_MULTI_DEF_CD_S_INS_NEW,0,CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Definition,,,DB Connection,,1,,Relational,$DBConnection_Target,Update else Insert,NO,Relational Reader,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Relational Reader,Source Qualifier,READER,Input Type,File,Parameter Filename,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,FRIDAY,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,Recovery Strategy,Restart task,,,,,,t_preload_multi_def_cd,NO,Command,2,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,YES,YES,YES,t_presession_stg_cntry_multi_def_cd,NO,t_presession_stg_cntry_multi_def_cd,Command,YES,$t_presession_stg_cntry_multi_def_cd.ErrorCode = 0,t_presession_stg_cntry_multi_def_cd,s_src_stg_cntry_multi_def_cd,integer,,Error code for this task's execution,NO,NO,$t_postsession_idw_cntry_multi_def_cd.ErrorCode,NO,Save Workflow log by,By timestamp,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CHANGE_IND,,INPUT/OUTPUT,1,0,Select Distinct,NO,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,exp_cntry_multi_def_cd_INS_DEL,1,NO,Expression,2,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_INS_DEL,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,,CNTRY_SCHM_VALD_IN,SQ_cntry_multi_def_cd_daily,Source Qualifier,CNTRY_SCHM_VALD_IN,CNTRY_MULTI_DEF_CD_S,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,DW_AS_OF_DT,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Maximum Memory Allowed For Auto Memory Attributes,0,,,,,Advanced,,YES,PASS THROUGH,3,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,2,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,,,DB Connection,,1,,Relational,$DBConnection_Target,Delete,NO,Relational Writer,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Relational Writer,Target Definition,WRITER,Input Type,File,Enable Test Load,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,SATURDAY,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,Recovery Strategy,Restart task,,,,,,t_postload_idw_cntry_multi_def_cd,NO,Command,2,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,YES,YES,YES,s_src_stg_cntry_multi_def_cd,YES,s_src_stg_cntry_multi_def_cd,Session,YES,,Start,t_preload_multi_def_cd,string,,Error message for this task's execution,NO,NO,$t_postsession_idw_cntry_multi_def_cd.ErrorMsg,NO,Save workflow log for these runs,0,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Is Partitionable,NO,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,exp_cntry_multi_def_cd_ins_new,1,NO,Expression,2,decimal,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_INS_NEW,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,,CNTRY_CD,SQ_cntry_multi_def_cd_daily,Source Qualifier,CNTRY_CD,CNTRY_MULTI_DEF_CD_S,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,"TO_DATE('9999-12-31','YYYY-MM-DD')",GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Maximum Percentage of Total Memory Allowed For Auto Memory Attributes,5,,,,,Advanced,,NO,PASS THROUGH,3,exp_cntry_multi_def_cd_ins_new,2,exp_cntry_multi_def_cd_ins_new,Expression,,,DB Connection,,1,,Relational,$DBConnection_Source,Truncate target table option,YES,Relational Writer,CNTRY_MULTI_DEF_CD_T_UPD_DEL,Relational Writer,Target Definition,WRITER,Input Type,File,$Source connection value,$DBConnection_Source,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,SUNDAY,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,Recovery Strategy,Restart task,,,,,,t_postsession_cntry_multi_def_cd,NO,Command,2,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,YES,YES,YES,t_preload_multi_def_cd,NO,t_preload_multi_def_cd,Command,YES,$t_postsession_idw_cntry_multi_def_cd.ErrorCode = 0,t_postsession_idw_cntry_multi_def_cd,t_postload_idw_cntry_multi_def_cd,date/time,,The time this task started,NO,NO,$Start.StartTime,NO,Service Name,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_SCHEME_CD,,INPUT/OUTPUT,8,0,Pre SQL,,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,exp_cntry_multi_def_cd_upd_chg,1,NO,Expression,2,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,TRANSFORMATION,,AUDIT_UPDT_USER_ID,SQ_cntry_multi_def_cd_daily,Source Qualifier,AUDIT_UPDT_USER_ID,CNTRY_MULTI_DEF_CD_S,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,1,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Additional Concurrent Pipelines for Lookup Cache Creation,0,,,,,Advanced,,YES,PASS THROUGH,2,CNTRY_MULTI_DEF_CD_T_UPD_CHG,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_Source,Reject file directory,,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_DEL,Relational Writer,Target Definition,WRITER,Input Type,File,$Target connection value,$DBConnection_Target,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,YES,YES,YES,t_postload_idw_cntry_multi_def_cd,NO,t_postload_idw_cntry_multi_def_cd,Command,YES,$s_src_stg_cntry_multi_def_cd.ErrorCode = 0,s_src_stg_cntry_multi_def_cd,t_postsession_cntry_multi_def_cd,date/time,,The time this task completed,NO,NO,$Start.EndTime,NO,Service Timeout,0,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_SCHM_VALD_IN,,INPUT/OUTPUT,1,0,Post SQL,,Created by:Saurabh Jain Created Date:  Description:Stage to Target level data loading,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,1,NO,Source Qualifier,2,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description:Stage to Target level data loading,SQ_CNTRY_MULTI_DEF_CD_T_UPD_DEL,SQ_CNTRY_MULTI_DEF_CD_T_UPD_DEL,Source Qualifier,TRANSFORMATION,,OUT_AUDIT_UPDT_TS,exp_cntry_multi_def_cd,Expression,AUDIT_UPDT_TS,CNTRY_MULTI_DEF_CD_S,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,0,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Custom Properties,,,,,,Advanced,,YES,PASS THROUGH,1,CNTRY_MULTI_DEF_CD_T_UPD_DEL,4,CNTRY_MULTI_DEF_CD_T_UPD_DEL,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_Source,Reject filename,$Badfile_File,Relational Reader,CNTRY_MULTI_DEF_CD_S_UPD_CHG,Relational Reader,Source Definition,READER,Input Type,File,Treat source rows as,Insert,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,YES,t_postsession_cntry_multi_def_cd,NO,t_postsession_cntry_multi_def_cd,Command,,,,,integer,,Status of this task's execution,NO,NO,$Start.Status,NO,Is Service Visible,NO,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_CD,,INPUT/OUTPUT,8,0,Output is deterministic,NO,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,exp_cntry_multi_def_cd_upd_del,1,NO,Expression,2,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description:Stage to Target level data loading,SQ_CNTRY_MULTI_DEF_CD_T_UPD_CHG,SQ_CNTRY_MULTI_DEF_CD_T_UPD_CHG,Source Qualifier,TRANSFORMATION,,CNTRY_NM,SQ_cntry_multi_def_cd_daily,Source Qualifier,CNTRY_NM,CNTRY_MULTI_DEF_CD_S,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,CNTRY_CD,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Pre-build lookup cache,Auto,,,,,Advanced,,YES,,4,CNTRY_MULTI_DEF_CD_T_INS_DEL,5,CNTRY_MULTI_DEF_CD_T_INS_DEL,Target Definition,,,,,,,,,Concurrent read partitioning,Optimize throughput,Relational Reader,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Relational Reader,Source Definition,READER,Input Type,File,Commit Type,Target,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of the previous task that is not disabled,NO,NO,$Start.PrevTaskStatus,NO,Is Service Protected,NO,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_NM,,INPUT/OUTPUT,60,0,Output is repeatable,Never,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_del_cntry_multi_def_cd,1,NO,Update Strategy,2,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description:Stage to Target level data loading,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,TRANSFORMATION,,OUTPUT_RUNDATE,SQ_cntry_multi_def_cd_daily,Source Qualifier,IN_OUTPUT_RUNDATE,exp_cntry_multi_def_cd,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,CNTRY_NM,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Optimization Level,Medium,,,,,Advanced,,NO,,0,CNTRY_MULTI_DEF_CD_S_UPD_CHG,0,CNTRY_MULTI_DEF_CD_S_UPD_CHG,Source Definition,,,,,,,,,Command Type,Command Generating Data,Relational Reader,SQ_CNTRY_MULTI_DEF_CD_T_UPD_CHG,Relational Reader,Source Qualifier,READER,Input Type,File,Commit Interval,10000,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Error code for this task's execution,NO,NO,$Start.ErrorCode,NO,Fail task after wait time,0,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,AUDIT_UPDT_USER_ID,,INPUT/OUTPUT,30,0,Forward Rejected Rows,YES,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description:Stage to Target level data loading,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_S,Source Definition,SOURCE,,AUDIT_UPDT_TS,SQ_cntry_multi_def_cd_daily,Source Qualifier,IN_AUDIT_UPDT_TS,exp_cntry_multi_def_cd,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,CNTRY_SCHM_VALD_IN,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,DateTime Format String,MM/DD/YYYY HH24:MI:SS,,,,,Advanced,,NO,,0,CNTRY_MULTI_DEF_CD_T_UPD_CHG,0,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Source Definition,,,,,,,,,Source filetype,Direct,Relational Reader,CNTRY_MULTI_DEF_CD_S_UPD_DEL,Relational Reader,Source Definition,READER,Input Type,File,Commit On End Of File,YES,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,string,,Error message for this task's execution,NO,NO,$Start.ErrorMsg,NO,Enable HA recovery,NO,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,AUDIT_UPDT_TS,,INPUT/OUTPUT,26,0,Tracing Level,Normal,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,exp_cntry_multi_def_cd_INS_DEL,exp_cntry_multi_def_cd_INS_DEL,Expression,TRANSFORMATION,,CHANGE_IND,cntry_multi_def_cd_daily,Source Definition,CHANGE_IND,SQ_cntry_multi_def_cd_daily,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,AUDIT_UPDT_USER_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Pre 85 Timestamp Compatibility,NO,,,,,Advanced,,YES,,2,SQ_CNTRY_MULTI_DEF_CD_T_UPD_CHG,6,SQ_CNTRY_MULTI_DEF_CD_T_UPD_CHG,Source Qualifier,,,,,,,,,Source file directory,,Relational Reader,CNTRY_MULTI_DEF_CD_T_UPD_DEL,Relational Reader,Source Definition,READER,Input Type,File,Rollback Transactions on Errors,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,date/time,,The time this task started,NO,NO,$s_stg_idw_cntry_multi_def_cd.StartTime,NO,Automatically recover terminated tasks,NO,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_TYPE_CD,,INPUT/OUTPUT,8,0,User Defined Join,,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description:Stage to Target level data loading...,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S,Source Definition,SOURCE,,SWB_CNTRY_ID,cntry_multi_def_cd_daily,Source Definition,SWB_CNTRY_ID,SQ_cntry_multi_def_cd_daily,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,AUDIT_UPDT_TS,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Log Options,0,,,,,Advanced,,NO,,2,exp_cntry_multi_def_cd_upd_chg,6,exp_cntry_multi_def_cd_upd_chg,Expression,,,,,,,,,Source filename,$$Input_File_Name,Relational Reader,SQ_CNTRY_MULTI_DEF_CD_T_UPD_DEL,Relational Reader,Source Qualifier,READER,Input Type,File,Recovery Strategy,Restart task,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,date/time,,The time this task completed,NO,NO,$s_stg_idw_cntry_multi_def_cd.EndTime,NO,Service Level Name,Default,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,DW_EFF_DT,,INPUT/OUTPUT,29,9,Source Filter,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description:Stage to Target level data loading,CNTRY_MULTI_DEF_CD_S_UPD_CHG,CNTRY_MULTI_DEF_CD_S,Source Definition,SOURCE,,CNTRY_SCHEME_CD,cntry_multi_def_cd_daily,Source Definition,CNTRY_SCHEME_CD,SQ_cntry_multi_def_cd_daily,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SESSSTARTTIME,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Save session log by,Session runs,,,,,Advanced,,NO,,2,upd_cntry_multi_def_cd_UPD_CHG,6,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,,,,,,,,,Command,,Relational Reader,CNTRY_MULTI_DEF_CD_S_INS_DEL,Relational Reader,Source Definition,READER,Input Type,File,Java Classpath,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of this task's execution,NO,NO,$s_stg_idw_cntry_multi_def_cd.Status,NO,Allow concurrent run with unique run instance name,NO,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,OUT_DW_EXPR_DT,,INPUT/OUTPUT,29,9,Number Of Sorted Ports,0,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description:Stage to Target level data loading,CNTRY_MULTI_DEF_CD_S_INS_DEL,CNTRY_MULTI_DEF_CD_S,Source Definition,SOURCE,,CNTRY_SCHM_VALD_IN,cntry_multi_def_cd_daily,Source Definition,CNTRY_SCHM_VALD_IN,SQ_cntry_multi_def_cd_daily,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,CNTRY_SCHEME_CD,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Save session log for these runs,$PMSessionLogCount,,,,,Advanced,,NO,,0,CNTRY_MULTI_DEF_CD_S_UPD_DEL,0,CNTRY_MULTI_DEF_CD_S_UPD_DEL,Source Definition,,,,,,,,,File Reader Truncate String Null,NO,Relational Reader,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Relational Reader,Source Qualifier,READER,Input Type,File,Performance,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of the previous task that is not disabled,NO,NO,$s_stg_idw_cntry_multi_def_cd.PrevTaskStatus,NO,Allow concurrent run with same run instance name,NO,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,OUT_CURR_IN,,INPUT/OUTPUT,5,0,Tracing Level,Normal,,,,,,,small integer,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description:Stage to Target level data loading,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Source Definition,SOURCE,,CNTRY_CD,cntry_multi_def_cd_daily,Source Definition,CNTRY_CD,SQ_cntry_multi_def_cd_daily,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,DW_AS_OF_DT,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Session Log File Max Size,0,,,,,Advanced,,NO,,0,CNTRY_MULTI_DEF_CD_T_UPD_DEL,0,CNTRY_MULTI_DEF_CD_T_UPD_DEL,Source Definition,,,,,,,,,Codepage Parameter,,,,,,,Input Type,File,DTM buffer size,Auto,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Error code for this task's execution,NO,NO,$s_stg_idw_cntry_multi_def_cd.ErrorCode,NO,Maximum number of concurrent runs,0,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,OUT_DW_LOAD_TS,,INPUT/OUTPUT,29,9,Select Distinct,NO,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description:Stage to Target level data loading,CNTRY_MULTI_DEF_CD_T_UPD_DEL,CNTRY_MULTI_DEF_CD_T,Source Definition,SOURCE,,CNTRY_NM,cntry_multi_def_cd_daily,Source Definition,CNTRY_NM,SQ_cntry_multi_def_cd_daily,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,"TO_DATE('9999-12-31' , 'YYYY-MM-DD')",GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Session Log File Max Time Period,0,,,,,Advanced,,YES,,1,SQ_CNTRY_MULTI_DEF_CD_T_UPD_DEL,7,SQ_CNTRY_MULTI_DEF_CD_T_UPD_DEL,Source Qualifier,,,,,,,,,Insert,YES,,,,,,Input Type,File,Collect performance data,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,string,,Error message for this task's execution,NO,NO,$s_stg_idw_cntry_multi_def_cd.ErrorMsg,NO,Assigned Web Services Hubs,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_TYPE_CD,,INPUT/OUTPUT,8,0,Is Partitionable,NO,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,exp_cntry_multi_def_cd_ins_new,exp_cntry_multi_def_cd_ins_new,Expression,TRANSFORMATION,,AUDIT_UPDT_USER_ID,cntry_multi_def_cd_daily,Source Definition,AUDIT_UPDT_USER_ID,SQ_cntry_multi_def_cd_daily,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,1,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Maximum Partial Session Log Files,1,,,,,Advanced,,NO,,1,upd_del_cntry_multi_def_cd,7,upd_del_cntry_multi_def_cd,Update Strategy,,,,,,,,,Update as Update,NO,,,,,,Input Type,File,Write performance data to repository,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,bigint,,Rows successfully read,NO,NO,$s_stg_idw_cntry_multi_def_cd.SrcSuccessRows,NO,Maximum number of concurrent runs per Hub,1000,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,DW_EFF_DT,,INPUT/OUTPUT,29,9,Pre SQL,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,exp_cntry_multi_def_cd_upd_chg,exp_cntry_multi_def_cd_upd_chg,Expression,TRANSFORMATION,,AUDIT_UPDT_TS,cntry_multi_def_cd_daily,Source Definition,AUDIT_UPDT_TS,SQ_cntry_multi_def_cd_daily,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,1,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Writer Commit Statistics Log Frequency,1,,,,,Advanced,,NO,,1,exp_cntry_multi_def_cd_upd_del,7,exp_cntry_multi_def_cd_upd_del,Expression,,,,,,,,,Update as Insert,NO,,,,,,Input Type,File,Incremental Aggregation,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,bigint,,Rows failed to read,NO,NO,$s_stg_idw_cntry_multi_def_cd.SrcFailedRows,NO,Expected Service Time,1,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,IN_DW_AS_OF_DT,,INPUT/OUTPUT,29,9,Post SQL,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description:Stage to Target level data loading,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,TRANSFORMATION,,OUTPUT_RUNDATE,cntry_multi_def_cd_daily,Source Definition,OUTPUT_RUNDATE,SQ_cntry_multi_def_cd_daily,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,CNTRY_CD,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Writer Commit Statistics Log Interval,0,,,,,Advanced,,NO,,0,CNTRY_MULTI_DEF_CD_S_INS_DEL,0,CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Definition,,,,,,,,,Update else Insert,NO,,,,,,Input Type,File,Enable high precision,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,bigint,,Rows successfully loaded,NO,NO,$s_stg_idw_cntry_multi_def_cd.TgtSuccessRows,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_TYPE_CD,,INPUT/OUTPUT,8,0,Output is deterministic,NO,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,exp_cntry_multi_def_cd_upd_del,exp_cntry_multi_def_cd_upd_del,Expression,TRANSFORMATION,,SWB_CNTRY_ID,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,SWB_CNTRY_ID,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,CNTRY_NM,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Error handling,,,,,,Advanced,,YES,,4,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,8,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,,,,,,,,,Delete,NO,,,,,,Input Type,File,Session retry on deadlock,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,bigint,,Rows failed to load,NO,NO,$s_stg_idw_cntry_multi_def_cd.TgtFailedRows,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,DW_EFF_DT,,INPUT/OUTPUT,29,9,Output is repeatable,Never,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_del_cntry_multi_def_cd,upd_del_cntry_multi_def_cd,Update Strategy,TRANSFORMATION,,CNTRY_TYPE_CD,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,CNTRY_TYPE_CD,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,CNTRY_SCHM_VALD_IN,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Stop on errors,1,,,,,Advanced,,NO,,4,exp_cntry_multi_def_cd_INS_DEL,8,exp_cntry_multi_def_cd_INS_DEL,Expression,,,,,,,,,Truncate target table option,NO,,,,,,Input Type,File,Pushdown Optimization,None,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Total number of transformation errors,NO,NO,$s_stg_idw_cntry_multi_def_cd.TotalTransErrors,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,IN_DW_AS_OF_DT,,INPUT/OUTPUT,29,9,User Defined Join,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_EFF_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EFF_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,AUDIT_UPDT_USER_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Override tracing,Normal,,,,,Advanced,,,,,,,,,,,,,,,,,Reject file directory,,,,,,,Input Type,File,Allow Temporary View for Pushdown,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,First error code,NO,NO,$s_stg_idw_cntry_multi_def_cd.FirstErrorCode,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_SCHEME_CD,,INPUT/OUTPUT,8,0,Source Filter,,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_CURR_IN,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,CURR_IN,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,AUDIT_UPDT_TS,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,On Stored Procedure error,Stop,,,,,Advanced,,,,,,,,,,,,,,,,,Reject filename,$BadFile_ins_new,,,,,,Input Type,File,Allow Temporary Sequence for Pushdown,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,string,,First error message,NO,NO,$s_stg_idw_cntry_multi_def_cd.FirstErrorMsg,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,DW_AS_OF_DT,,INPUT/OUTPUT,29,9,Number Of Sorted Ports,0,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_DW_LOAD_TS,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_LOAD_TS,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SESSSTARTTIME,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,On Pre-session command task error,Stop,,,,,Advanced,,,,,,,,,,,,,,,,,Insert,NO,,,,,,Input Type,File,Allow Pushdown for User Incompatible Connections,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,date/time,,The time this task started,NO,NO,$t_presession_idw_cntry_multi_def_cd.StartTime,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_CD,,INPUT/OUTPUT,8,0,Tracing Level,Normal,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_DW_LOAD_TS,upd_del_cntry_multi_def_cd,Update Strategy,DW_LOAD_TS,CNTRY_MULTI_DEF_CD_T_UPD_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,CNTRY_TYPE_CD,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,On Pre-Post SQL error,Stop,,,,,Advanced,,,,,,,,,,,,,,,,,Update as Update,YES,,,,,,Input Type,File,Write Backward Compatible Session Log File,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,date/time,,The time this task completed,NO,NO,$t_presession_idw_cntry_multi_def_cd.EndTime,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_NM,,INPUT/OUTPUT,60,0,Select Distinct,NO,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,SWB_CNTRY_ID,upd_del_cntry_multi_def_cd,Update Strategy,SWB_CNTRY_ID,CNTRY_MULTI_DEF_CD_T_UPD_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,DW_EFF_DT,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Enable Recovery,NO,,,,,Advanced,,,,,,,,,,,,,,,,,Update as Insert,NO,,,,,,Input Type,File,Session Log File Name,$PMSessionLogFile,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of this task's execution,NO,NO,$t_presession_idw_cntry_multi_def_cd.Status,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_SCHM_VALD_IN,,INPUT/OUTPUT,1,0,Is Partitionable,NO,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_TYPE_CD,upd_del_cntry_multi_def_cd,Update Strategy,CNTRY_TYPE_CD,CNTRY_MULTI_DEF_CD_T_UPD_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,"ADD_TO_DATE(IN_DW_AS_OF_DT,'DD', -1)",GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Error Log Type,Flat File,,,,,Advanced,,,,,,,,,,,,,,,,,Update else Insert,NO,,,,,,Input Type,File,Session Log File directory,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of the previous task that is not disabled,NO,NO,$t_presession_idw_cntry_multi_def_cd.PrevTaskStatus,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,AUDIT_UPDT_USER_ID,,INPUT/OUTPUT,30,0,Pre SQL,,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_EFF_DT,upd_del_cntry_multi_def_cd,Update Strategy,DW_EFF_DT,CNTRY_MULTI_DEF_CD_T_UPD_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,0,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Error Log Table Name Prefix,,,,,,Advanced,,,,,,,,,,,,,,,,,Delete,NO,,,,,,Input Type,File,Parameter Filename,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Error code for this task's execution,NO,NO,$t_presession_idw_cntry_multi_def_cd.ErrorCode,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,AUDIT_UPDT_TS,,INPUT/OUTPUT,29,9,Post SQL,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_DW_EXPR_DT,upd_del_cntry_multi_def_cd,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SESSSTARTTIME,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Error Log File Directory,$PMBadFileDir\,,,,,Advanced,,,,,,,,,,,,,,,,,Truncate target table option,NO,,,,,,Input Type,File,Enable Test Load,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,string,,Error message for this task's execution,NO,NO,$t_presession_idw_cntry_multi_def_cd.ErrorMsg,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_SCHEME_CD,,INPUT/OUTPUT,8,0,Output is deterministic,NO,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_CURR_IN,upd_del_cntry_multi_def_cd,Update Strategy,CURR_IN,CNTRY_MULTI_DEF_CD_T_UPD_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,CNTRY_TYPE_CD,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Error Log File Name,PMError.log,,,,,Advanced,,,,,,,,,,,,,,,,,Reject file directory,,,,,,,Input Type,File,$Source connection value,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,date/time,,The time this task started,NO,NO,$t_presession_stg_cntry_multi_def_cd.StartTime,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,DW_AS_OF_DT,,INPUT/OUTPUT,29,9,Output is repeatable,Never,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_SCHEME_CD,exp_cntry_multi_def_cd_INS_DEL,Expression,CNTRY_TYPE_CD,CNTRY_MULTI_DEF_CD_T_INS_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,DW_EFF_DT,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Log Row Data,YES,,,,,Advanced,,,,,,,,,,,,,,,,,Reject filename,$BadFile_upd_chg,,,,,,Input Type,File,$Target connection value,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,date/time,,The time this task completed,NO,NO,$t_presession_stg_cntry_multi_def_cd.EndTime,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_DW_EXPR_DT,,OUTPUT,29,9,User Defined Join,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_DW_EXPR_DT,exp_cntry_multi_def_cd_INS_DEL,Expression,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_INS_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,"ADD_TO_DATE(IN_DW_AS_OF_DT,'DD', -1)",GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Log Source Row Data,YES,,,,,Advanced,,,,,,,,,,,,,,,,,Insert,NO,,,,,,Input Type,File,Treat source rows as,Data driven,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of this task's execution,NO,NO,$t_presession_stg_cntry_multi_def_cd.Status,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_CURR_IN,,OUTPUT,5,0,Source Filter,,,,,,,,small integer,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_CURR_IN,exp_cntry_multi_def_cd_INS_DEL,Expression,CURR_IN,CNTRY_MULTI_DEF_CD_T_INS_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,0,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Data Column Delimiter,|,,,,,Advanced,,,,,,,,,,,,,,,,,Update as Update,YES,,,,,,Input Type,File,Commit Type,Target,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of the previous task that is not disabled,NO,NO,$t_presession_stg_cntry_multi_def_cd.PrevTaskStatus,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_RCV_IN,,OUTPUT,5,0,Number Of Sorted Ports,0,,,,,,,small integer,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_RCV_IN,exp_cntry_multi_def_cd_INS_DEL,Expression,RCV_IN,CNTRY_MULTI_DEF_CD_T_INS_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SESSSTARTTIME,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Partitioning Options,,,,,,Advanced,,,,,,,,,,,,,,,,,Update as Insert,NO,,,,,,Input Type,File,Commit Interval,10000,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Error code for this task's execution,NO,NO,$t_presession_stg_cntry_multi_def_cd.ErrorCode,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_CD,,INPUT/OUTPUT,8,0,Tracing Level,Normal,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_NM,exp_cntry_multi_def_cd_INS_DEL,Expression,CNTRY_NM,CNTRY_MULTI_DEF_CD_T_INS_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Dynamic Partitioning,Disabled,,,,,Advanced,,,,,,,,,,,,,,,,,Update else Insert,NO,,,,,,Input Type,File,Commit On End Of File,YES,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,string,,Error message for this task's execution,NO,NO,$t_presession_stg_cntry_multi_def_cd.ErrorMsg,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_NM,,INPUT/OUTPUT,60,0,Select Distinct,NO,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_CD,exp_cntry_multi_def_cd_INS_DEL,Expression,CNTRY_CD,CNTRY_MULTI_DEF_CD_T_INS_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Number of Partitions,1,,,,,Advanced,,,,,,,,,,,,,,,,,Delete,NO,,,,,,Input Type,File,Rollback Transactions on Errors,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,date/time,,The time this task started,NO,NO,$s_src_stg_cntry_multi_def_cd.StartTime,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_SCHM_VALD_IN,,INPUT/OUTPUT,1,0,Is Partitionable,NO,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_SCHM_VALD_IN,exp_cntry_multi_def_cd_INS_DEL,Expression,CNTRY_TYPE_VALID_IN,CNTRY_MULTI_DEF_CD_T_INS_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Multiplication Factor,Auto,,,,,Advanced,,,,,,,,,,,,,,,,,Truncate target table option,NO,,,,,,Input Type,File,Recovery Strategy,Restart task,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,date/time,,The time this task completed,NO,NO,$s_src_stg_cntry_multi_def_cd.EndTime,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,AUDIT_UPDT_USER_ID,,INPUT/OUTPUT,30,0,Pre SQL,,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,AUDIT_UPDT_USER_ID,exp_cntry_multi_def_cd_INS_DEL,Expression,AUDIT_UPDT_USER_ID,CNTRY_MULTI_DEF_CD_T_INS_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Session on Grid,,,,,,Advanced,,,,,,,,,,,,,,,,,Reject file directory,,,,,,,Input Type,File,Java Classpath,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of this task's execution,NO,NO,$s_src_stg_cntry_multi_def_cd.Status,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,AUDIT_UPDT_TS,,INPUT/OUTPUT,29,9,Post SQL,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,AUDIT_UPDT_TS,exp_cntry_multi_def_cd_INS_DEL,Expression,AUDIT_UPDT_TS,CNTRY_MULTI_DEF_CD_T_INS_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Is Enabled,NO,,,,,Advanced,,,,,,,,,,,,,,,,,Reject filename,$BadFile_upd_del,,,,,,Input Type,File,Performance,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of the previous task that is not disabled,NO,NO,$s_src_stg_cntry_multi_def_cd.PrevTaskStatus,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_DW_LOAD_TS,,OUTPUT,29,9,Output is deterministic,NO,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_DW_LOAD_TS,exp_cntry_multi_def_cd_INS_DEL,Expression,DW_LOAD_TS,CNTRY_MULTI_DEF_CD_T_INS_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Constraint based load ordering,NO,,,,,Advanced,,,,,,,,,,,,,,,,,Insert,YES,,,,,,Input Type,File,DTM buffer size,Auto,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Error code for this task's execution,NO,NO,$s_src_stg_cntry_multi_def_cd.ErrorCode,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_SCHEME_CD,,INPUT/OUTPUT,8,0,Output is repeatable,Never,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_AS_OF_DT,exp_cntry_multi_def_cd_INS_DEL,Expression,DW_EFF_DT,CNTRY_MULTI_DEF_CD_T_INS_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Cache LOOKUP() function,YES,,,,,Advanced,,,,,,,,,,,,,,,,,Update as Update,NO,,,,,,Input Type,File,Collect performance data,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,string,,Error message for this task's execution,NO,NO,$s_src_stg_cntry_multi_def_cd.ErrorMsg,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,DW_AS_OF_DT,,INPUT/OUTPUT,29,9,User Defined Join,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,SWB_CNTRY_ID,exp_cntry_multi_def_cd_INS_DEL,Expression,SWB_CNTRY_ID,CNTRY_MULTI_DEF_CD_T_INS_DEL,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Default buffer block size,Auto,,,,,Advanced,,,,,,,,,,,,,,,,,Update as Insert,NO,,,,,,Input Type,File,Write performance data to repository,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,bigint,,Rows successfully read,NO,NO,$s_src_stg_cntry_multi_def_cd.SrcSuccessRows,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_DW_EXPR_DT,,OUTPUT,29,9,Source Filter,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_CD,exp_cntry_multi_def_cd_ins_new,Expression,CNTRY_CD,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Line Sequential buffer length,1024,,,,,Advanced,,,,,,,,,,,,,,,,,Update else Insert,NO,,,,,,Input Type,File,Incremental Aggregation,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,bigint,,Rows failed to read,NO,NO,$s_src_stg_cntry_multi_def_cd.SrcFailedRows,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_CURR_IN,,OUTPUT,5,0,Number Of Sorted Ports,0,,,,,,,small integer,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,SWB_CNTRY_ID,exp_cntry_multi_def_cd_ins_new,Expression,SWB_CNTRY_ID,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Maximum Memory Allowed For Auto Memory Attributes,0,,,,,Advanced,,,,,,,,,,,,,,,,,Delete,NO,,,,,,Input Type,File,Enable high precision,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,bigint,,Rows successfully loaded,NO,NO,$s_src_stg_cntry_multi_def_cd.TgtSuccessRows,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_RCV_IN,,OUTPUT,5,0,Tracing Level,Normal,,,,,,,small integer,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_SCHEME_CD,exp_cntry_multi_def_cd_ins_new,Expression,CNTRY_TYPE_CD,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Maximum Percentage of Total Memory Allowed For Auto Memory Attributes,5,,,,,Advanced,,,,,,,,,,,,,,,,,Truncate target table option,NO,,,,,,Input Type,File,Session retry on deadlock,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,bigint,,Rows failed to load,NO,NO,$s_src_stg_cntry_multi_def_cd.TgtFailedRows,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_CD,,INPUT/OUTPUT,8,0,Select Distinct,NO,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_AS_OF_DT,exp_cntry_multi_def_cd_ins_new,Expression,DW_EFF_DT,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Additional Concurrent Pipelines for Lookup Cache Creation,0,,,,,Advanced,,,,,,,,,,,,,,,,,Reject file directory,,,,,,,Input Type,File,Pushdown Optimization,None,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Total number of transformation errors,NO,NO,$s_src_stg_cntry_multi_def_cd.TotalTransErrors,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_NM,,INPUT/OUTPUT,60,0,Is Partitionable,NO,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_NM,exp_cntry_multi_def_cd_ins_new,Expression,CNTRY_NM,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Custom Properties,,,,,,Advanced,,,,,,,,,,,,,,,,,Reject filename,$BadFile_ins_del,,,,,,Input Type,File,Allow Temporary View for Pushdown,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,First error code,NO,NO,$s_src_stg_cntry_multi_def_cd.FirstErrorCode,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_SCHM_VALD_IN,,INPUT/OUTPUT,1,0,Pre SQL,,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_SCHM_VALD_IN,exp_cntry_multi_def_cd_ins_new,Expression,CNTRY_TYPE_VALID_IN,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Pre-build lookup cache,Auto,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,Allow Temporary Sequence for Pushdown,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,string,,First error message,NO,NO,$s_src_stg_cntry_multi_def_cd.FirstErrorMsg,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,AUDIT_UPDT_USER_ID,,INPUT/OUTPUT,30,0,Post SQL,,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,AUDIT_UPDT_USER_ID,exp_cntry_multi_def_cd_ins_new,Expression,AUDIT_UPDT_USER_ID,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Optimization Level,Medium,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,Allow Pushdown for User Incompatible Connections,NO,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,date/time,,The time this task started,NO,NO,$t_preload_multi_def_cd.StartTime,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,AUDIT_UPDT_TS,,INPUT/OUTPUT,29,9,Output is deterministic,NO,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,AUDIT_UPDT_TS,exp_cntry_multi_def_cd_ins_new,Expression,AUDIT_UPDT_TS,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,DateTime Format String,MM/DD/YYYY HH24:MI:SS,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,date/time,,The time this task completed,NO,NO,$t_preload_multi_def_cd.EndTime,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_DW_LAOD_TS,,OUTPUT,29,9,Output is repeatable,Never,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_DW_LAOD_TS,exp_cntry_multi_def_cd_ins_new,Expression,DW_LOAD_TS,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Pre 85 Timestamp Compatibility,NO,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of this task's execution,NO,NO,$t_preload_multi_def_cd.Status,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_TYPE_CD,,INPUT/OUTPUT,8,0,Forward Rejected Rows,YES,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_DW_EXPR_DT,exp_cntry_multi_def_cd_ins_new,Expression,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Log Options,0,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of the previous task that is not disabled,NO,NO,$t_preload_multi_def_cd.PrevTaskStatus,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,DW_EFF_DT,,INPUT/OUTPUT,29,9,Tracing Level,Normal,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_CURR_IN,exp_cntry_multi_def_cd_ins_new,Expression,CURR_IN,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Save session log by,Session runs,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Error code for this task's execution,NO,NO,$t_preload_multi_def_cd.ErrorCode,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,IN_DW_AS_OF_DT,,INPUT,29,9,,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_RCV_IN,exp_cntry_multi_def_cd_ins_new,Expression,RCV_IN,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Save session log for these runs,$PMSessionLogCount,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,string,,Error message for this task's execution,NO,NO,$t_preload_multi_def_cd.ErrorMsg,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_DW_EXPR_DT,,OUTPUT,29,9,,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,SWB_CNTRY_ID,exp_cntry_multi_def_cd_upd_chg,Expression,SWB_CNTRY_ID,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Session Log File Max Size,0,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,date/time,,The time this task started,NO,NO,$t_postload_idw_cntry_multi_def_cd.StartTime,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_CURR_IN,,OUTPUT,5,0,,,,,,,,,small integer,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_TYPE_CD,exp_cntry_multi_def_cd_upd_chg,Expression,CNTRY_TYPE_CD,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Session Log File Max Time Period,0,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,date/time,,The time this task completed,NO,NO,$t_postload_idw_cntry_multi_def_cd.EndTime,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,OUT_DW_LOAD_TS,,OUTPUT,29,9,,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_EFF_DT,exp_cntry_multi_def_cd_upd_chg,Expression,DW_EFF_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Maximum Partial Session Log Files,1,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of this task's execution,NO,NO,$t_postload_idw_cntry_multi_def_cd.Status,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_SCHEME_CD,,INPUT/OUTPUT,8,0,,,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_DW_EXPR_DT,exp_cntry_multi_def_cd_upd_chg,Expression,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Writer Commit Statistics Log Frequency,1,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of the previous task that is not disabled,NO,NO,$t_postload_idw_cntry_multi_def_cd.PrevTaskStatus,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,DW_AS_OF_DT,,INPUT/OUTPUT,29,9,,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_CURR_IN,exp_cntry_multi_def_cd_upd_chg,Expression,OUT_CURR_IN,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Writer Commit Statistics Log Interval,0,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Error code for this task's execution,NO,NO,$t_postload_idw_cntry_multi_def_cd.ErrorCode,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_CD,,INPUT/OUTPUT,8,0,,,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_DW_LOAD_TS,exp_cntry_multi_def_cd_upd_chg,Expression,OUT_DW_LOAD_TS,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Error handling,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,string,,Error message for this task's execution,NO,NO,$t_postload_idw_cntry_multi_def_cd.ErrorMsg,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_NM,,INPUT/OUTPUT,60,0,,,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,SWB_CNTRY_ID,SQ_CNTRY_MULTI_DEF_CD_T_UPD_DEL,Source Qualifier,SWB_CNTRY_ID,exp_cntry_multi_def_cd_upd_del,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Stop on errors,0,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,date/time,,The time this task started,NO,NO,$t_postsession_cntry_multi_def_cd.StartTime,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_SCHM_VALD_IN,,INPUT/OUTPUT,1,0,,,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_TYPE_CD,SQ_CNTRY_MULTI_DEF_CD_T_UPD_DEL,Source Qualifier,CNTRY_TYPE_CD,exp_cntry_multi_def_cd_upd_del,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Override tracing,Normal,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,date/time,,The time this task completed,NO,NO,$t_postsession_cntry_multi_def_cd.EndTime,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,AUDIT_UPDT_USER_ID,,INPUT/OUTPUT,30,0,,,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_EFF_DT,SQ_CNTRY_MULTI_DEF_CD_T_UPD_DEL,Source Qualifier,DW_EFF_DT,exp_cntry_multi_def_cd_upd_del,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,On Stored Procedure error,Stop,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of this task's execution,NO,NO,$t_postsession_cntry_multi_def_cd.Status,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,AUDIT_UPDT_TS,,INPUT/OUTPUT,29,9,,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,IN_DW_AS_OF_DT,SQ_CNTRY_MULTI_DEF_CD_T_UPD_DEL,Source Qualifier,IN_DW_AS_OF_DT,exp_cntry_multi_def_cd_upd_del,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,On Pre-session command task error,Stop,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Status of the previous task that is not disabled,NO,NO,$t_postsession_cntry_multi_def_cd.PrevTaskStatus,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_TYPE_CD,,INPUT/OUTPUT,8,0,,,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_AS_OF_DT,CNTRY_MULTI_DEF_CD_S_UPD_DEL,Source Definition,IN_DW_AS_OF_DT,SQ_CNTRY_MULTI_DEF_CD_T_UPD_DEL,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,On Pre-Post SQL error,Stop,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,integer,,Error code for this task's execution,NO,NO,$t_postsession_cntry_multi_def_cd.ErrorCode,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,DW_EFF_DT,,INPUT/OUTPUT,29,9,,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,SWB_CNTRY_ID,CNTRY_MULTI_DEF_CD_T_UPD_DEL,Source Definition,SWB_CNTRY_ID,SQ_CNTRY_MULTI_DEF_CD_T_UPD_DEL,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Enable Recovery,NO,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,string,,Error message for this task's execution,NO,NO,$t_postsession_cntry_multi_def_cd.ErrorMsg,NO,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,IN_DW_AS_OF_DT,,INPUT,29,9,,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_TYPE_CD,CNTRY_MULTI_DEF_CD_T_UPD_DEL,Source Definition,CNTRY_TYPE_CD,SQ_CNTRY_MULTI_DEF_CD_T_UPD_DEL,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Error Log Type,Flat File,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,nstring,,,NO,NO,$$Input_File_Name,YES,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_DW_EXPR_DT,,OUTPUT,29,9,,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_EFF_DT,CNTRY_MULTI_DEF_CD_T_UPD_DEL,Source Definition,DW_EFF_DT,SQ_CNTRY_MULTI_DEF_CD_T_UPD_DEL,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Error Log Table Name Prefix,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,nstring,,,NO,NO,$$Log_File_Name,YES,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,ERROR('transformation error'),,OUT_CURR_IN,,OUTPUT,5,0,,,,,,,,,small integer,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,SWB_CNTRY_ID,SQ_CNTRY_MULTI_DEF_CD_T_UPD_CHG,Source Qualifier,SWB_CNTRY_ID,exp_cntry_multi_def_cd_upd_chg,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Error Log File Directory,$PMBadFileDir\,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,nstring,,,NO,NO,$$Input_Null_File_Name,YES,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,OUT_DW_LOAD_TS,,OUTPUT,29,9,,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_TYPE_CD,SQ_CNTRY_MULTI_DEF_CD_T_UPD_CHG,Source Qualifier,CNTRY_TYPE_CD,exp_cntry_multi_def_cd_upd_chg,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Error Log File Name,PMError.log,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,CNTRY_TYPE_CD,,INPUT/OUTPUT,8,0,,,,,,,,,string,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_EFF_DT,SQ_CNTRY_MULTI_DEF_CD_T_UPD_CHG,Source Qualifier,DW_EFF_DT,exp_cntry_multi_def_cd_upd_chg,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Log Row Data,YES,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,DW_EFF_DT,,INPUT/OUTPUT,29,9,,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,IN_DW_AS_OF_DT,SQ_CNTRY_MULTI_DEF_CD_T_UPD_CHG,Source Qualifier,IN_DW_AS_OF_DT,exp_cntry_multi_def_cd_upd_chg,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Log Source Row Data,YES,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,OUT_DW_EXPR_DT,,INPUT/OUTPUT,29,9,,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,SWB_CNTRY_ID,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Source Definition,SWB_CNTRY_ID,SQ_CNTRY_MULTI_DEF_CD_T_UPD_CHG,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Data Column Delimiter,|,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,OUT_CURR_IN,,INPUT/OUTPUT,5,0,,,,,,,,,small integer,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_TYPE_CD,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Source Definition,CNTRY_TYPE_CD,SQ_CNTRY_MULTI_DEF_CD_T_UPD_CHG,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Partitioning Options,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,OUT_DW_LOAD_TS,,INPUT/OUTPUT,29,9,,,,,,,,,date/time,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_EFF_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Source Definition,DW_EFF_DT,SQ_CNTRY_MULTI_DEF_CD_T_UPD_CHG,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Dynamic Partitioning,Disabled,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_AS_OF_DT,CNTRY_MULTI_DEF_CD_S_UPD_CHG,Source Definition,IN_DW_AS_OF_DT,SQ_CNTRY_MULTI_DEF_CD_T_UPD_CHG,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Number of Partitions,1,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_SCHM_VALD_IN,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,CNTRY_SCHM_VALD_IN,exp_cntry_multi_def_cd_ins_new,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Multiplication Factor,Auto,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,AUDIT_UPDT_USER_ID,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,AUDIT_UPDT_USER_ID,exp_cntry_multi_def_cd_ins_new,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Session on Grid,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,AUDIT_UPDT_TS,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,AUDIT_UPDT_TS,exp_cntry_multi_def_cd_ins_new,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,Is Enabled,NO,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,SWB_CNTRY_ID,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,SWB_CNTRY_ID,exp_cntry_multi_def_cd_ins_new,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,SWB_CNTRY_ID,CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Definition,SWB_CNTRY_ID,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_SCHEME_CD,CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Definition,CNTRY_SCHEME_CD,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_AS_OF_DT,CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Definition,DW_AS_OF_DT,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_CD,CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Definition,CNTRY_CD,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_NM,CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Definition,CNTRY_NM,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_SCHM_VALD_IN,CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Definition,CNTRY_SCHM_VALD_IN,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,AUDIT_UPDT_USER_ID,CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Definition,AUDIT_UPDT_USER_ID,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,AUDIT_UPDT_TS,CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Definition,AUDIT_UPDT_TS,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_SCHEME_CD,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,CNTRY_SCHEME_CD,exp_cntry_multi_def_cd_ins_new,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_AS_OF_DT,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,DW_AS_OF_DT,exp_cntry_multi_def_cd_ins_new,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_CD,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,CNTRY_CD,exp_cntry_multi_def_cd_ins_new,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_NM,SQ_CNTRY_MULTI_DEF_CD_S_INS_NEW,Source Qualifier,CNTRY_NM,exp_cntry_multi_def_cd_ins_new,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,SWB_CNTRY_ID,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,SWB_CNTRY_ID,exp_cntry_multi_def_cd_INS_DEL,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_SCHEME_CD,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,CNTRY_SCHEME_CD,exp_cntry_multi_def_cd_INS_DEL,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_AS_OF_DT,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,DW_AS_OF_DT,exp_cntry_multi_def_cd_INS_DEL,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_NM,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,CNTRY_NM,exp_cntry_multi_def_cd_INS_DEL,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_SCHM_VALD_IN,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,CNTRY_SCHM_VALD_IN,exp_cntry_multi_def_cd_INS_DEL,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,AUDIT_UPDT_USER_ID,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,AUDIT_UPDT_USER_ID,exp_cntry_multi_def_cd_INS_DEL,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,AUDIT_UPDT_TS,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,AUDIT_UPDT_TS,exp_cntry_multi_def_cd_INS_DEL,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_CD,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,CNTRY_CD,exp_cntry_multi_def_cd_INS_DEL,Expression,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,SWB_CNTRY_ID,CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Definition,SWB_CNTRY_ID,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_SCHEME_CD,CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Definition,CNTRY_SCHEME_CD,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_AS_OF_DT,CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Definition,DW_AS_OF_DT,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_CD,CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Definition,CNTRY_CD,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_NM,CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Definition,CNTRY_NM,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_SCHM_VALD_IN,CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Definition,CNTRY_SCHM_VALD_IN,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,AUDIT_UPDT_USER_ID,CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Definition,AUDIT_UPDT_USER_ID,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,AUDIT_UPDT_TS,CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Definition,AUDIT_UPDT_TS,SQ_CNTRY_MULTI_DEF_CD_S_INS_DEL,Source Qualifier,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,SWB_CNTRY_ID,exp_cntry_multi_def_cd_upd_del,Expression,SWB_CNTRY_ID,upd_del_cntry_multi_def_cd,Update Strategy,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,CNTRY_TYPE_CD,exp_cntry_multi_def_cd_upd_del,Expression,CNTRY_TYPE_CD,upd_del_cntry_multi_def_cd,Update Strategy,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,DW_EFF_DT,exp_cntry_multi_def_cd_upd_del,Expression,DW_EFF_DT,upd_del_cntry_multi_def_cd,Update Strategy,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_DW_EXPR_DT,exp_cntry_multi_def_cd_upd_del,Expression,OUT_DW_EXPR_DT,upd_del_cntry_multi_def_cd,Update Strategy,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_CURR_IN,exp_cntry_multi_def_cd_upd_del,Expression,OUT_CURR_IN,upd_del_cntry_multi_def_cd,Update Strategy,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
string,,,,,,,,,,,,,,,,,,,OUTPUT_RUNDATE,,INPUT/OUTPUT,10,0,Sql Query,,,,,,,,,,,,,,,,,,,,,OUT_DW_LOAD_TS,exp_cntry_multi_def_cd_upd_del,Expression,OUT_DW_LOAD_TS,upd_del_cntry_multi_def_cd,Update Strategy,,,,,,,,,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Implementation of SCD logic,upd_cntry_multi_def_cd_UPD_CHG,1,NO,Update Strategy,2,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT, DW_EXPR_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 AND RCV_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND T.DW_EXPR_DT=DATE '9999-12-31' AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT T.SWB_CNTRY_ID, T.CNTRY_TYPE_CD, T.DW_EFF_DT, S.DW_AS_OF_DT FROM  (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, RCV_IN, DW_EFF_DT, MAX(DW_EFF_DT) MAX_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=1 GROUP BY 1,2,3,4) T, (SELECT SWB_CNTRY_ID, CNTRY_SCHEME_CD, DW_AS_OF_DT, DW_ACTN_IND FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S) S WHERE  S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND (S.DW_ACTN_IND='U' OR (S.DW_ACTN_IND='I' AND T.RCV_IN=0)) AND S.DW_AS_OF_DT > T.MAX_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,           S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S S LEFT OUTER JOIN (SELECT  SWB_CNTRY_ID, CNTRY_TYPE_CD, CURR_IN, RCV_IN, DW_EXPR_DT, DW_EFF_DT AS MAX_DW_EFF_DT FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE (SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX_DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T ON S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD WHERE  ((S.DW_ACTN_IND='I' AND T.SWB_CNTRY_ID IS NULL AND T.CNTRY_TYPE_CD IS NULL)  OR (S.DW_ACTN_IND='I' AND RCV_IN=0)) OR (S.DW_ACTN_IND='U' AND T.CURR_IN=0 AND T.RCV_IN=1) AND S.DW_AS_OF_DT > COALESCE (T.MAX_DW_EFF_DT, DATE '0001-01-01')",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Sql Query,"LOCKING ROW FOR ACCESS SELECT S.SWB_CNTRY_ID, S.CNTRY_SCHEME_CD, S.DW_AS_OF_DT,         S.CNTRY_CD, S.CNTRY_NM, S.CNTRY_SCHM_VALD_IN, S.AUDIT_UPDT_USER_ID, S.AUDIT_UPDT_TS FROM  (SELECT * FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T WHERE CURR_IN=0 AND RCV_IN=1 AND (SWB_CNTRY_ID, CNTRY_TYPE_CD, DW_EFF_DT) IN (SELECT SWB_CNTRY_ID,CNTRY_TYPE_CD, MAX(DW_EFF_DT) FROM $$IDW_SCHEMA.CNTRY_MULTI_DEF_CD_T GROUP BY 1,2)) T, (SELECT * FROM $$STG_SCHEMA.CNTRY_MULTI_DEF_CD_S WHERE DW_ACTN_IND='D') S WHERE S.SWB_CNTRY_ID = T.SWB_CNTRY_ID AND S.CNTRY_SCHEME_CD = T.CNTRY_TYPE_CD AND S.DW_AS_OF_DT > T.DW_EFF_DT",1000000,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension,,INFORMATICA,integer,,,SWB_CNTRY_ID,GENERAL,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Tracing Level,Normal,integer,,,SWB_CNTRY_ID,,INPUT/OUTPUT,10,0,Update Strategy Expression,DD_UPDATE,Created by:Saurabh Jain Created Date:  Description: Target Table,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_T,Target Definition,TARGET,CNTRY_MULTI_DEF_CD_S_UPD_DEL,CNTRY_MULTI_DEF_CD_T_UPD_CHG,CNTRY_MULTI_DEF_CD_S_INS_NEW,CNTRY_MULTI_DEF_CD_S_INS_DEL,OUT_DW_EXPR_DT,upd_cntry_multi_def_cd_UPD_CHG,Update Strategy,DW_EXPR_DT,CNTRY_MULTI_DEF_CD_T_UPD_CHG,Target Definition,3,CNTRY_MULTI_DEF_CD_T_UPD_CHG,,,,,,,,,,,,,,,,,,,,,,,,,,,Advanced,,,,,,,,,,,,,,,,,,,,,,,,Input Type,File,,,,,,,,,,YES,PASS THROUGH,3,CNTRY_MULTI_DEF_CD_T_INS_NEW,1,CNTRY_MULTI_DEF_CD_T_INS_NEW,Target Definition,,,DB Connection,,1,,Relational,$DBConnection_TARGET,Target load type,Normal,Relational Writer,CNTRY_MULTI_DEF_CD_T_INS_NEW,Relational Writer,Target Definition,WRITER,Target load type,Normal,Target load type,Normal,Target load type,Normal,General Options,,7/20/2011,02:00,YES,,1,WEEKLY,CUSTOM,7/22/2011,ENDON,,Scheduler,NO,2,,,,,,,,,,,,Fail task if any command fails,YES,1,cmd_drop_index,NO,ksh $IDW_CMD/idw_idw_presession.ksh $DB_IDW_DATA cntry_multi_def_cd_t>>$$Log_File_Name,Fail task if any command fails,YES,1,cmd_backup_table,NO,ksh $IDW_CMD/idw_stg_presession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s>>$$Log_File_Name,Fail task if any command fails,YES,1,CMD_PRELOAD_FILE_CHECK,NO,ksh $IDW_CMD/idw_preload.ksh $$Input_File_Name > $$Log_File_Name,Fail task if any command fails,YES,1,cmd_postload,NO,ksh $IDW_CMD/idw_postload_new.ksh $DB_IDW_DATA cntry_multi_def_cd_t $$Log_File_Name >> $$Log_File_Name,Fail task if any command fails,YES,1,cmd_archive_data_file,NO,ksh $IDW_CMD/idw_stg_postsession.ksh $DB_IDW_STAGE cntry_multi_def_cd_s $$Input_File_Name >> $$Log_File_Name,,,,,,,,,,,,,,,,,,,,,,,YES,NO,NO,YES,wf_src_idw_cntry_multi_def_cd,NO,Scheduler,INS_IDW_ASCII,Dom_Prod,NO,NO,2,IDW_Code_Tables,,Administrator,NOTSHARED,,rwx------,b04bec80-0cd0-4dfc-bbf2-618b9f24661e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,Teradata,IDW_ETL_LOAD_IDW,,CNTRY_MULTI_DEF_CD_T,1,R3_IDW_DATA,2,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,Base Table Name,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,STRING,,User Defined Metadata Domain,YES,YES,YES,NO,NO,256,Extension_1,,INFORMATICA,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0,,,Teradata,,CNTRY_MULTI_DEF_CD_T,1,,2,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,varchar,,2,0,ELEMITEM,NO,PRIMARY KEY,0,0,CNTRY_TYPE_CD,NOTNULL,0,11,8,10,,8,0,,,Teradata,IDW_ETL_LOAD_STG,,CNTRY_MULTI_DEF_CD_S,1,R3_IDW_STAGE,2,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,Search Specification,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,STRING,,User Defined Metadata Domain,YES,YES,YES,NO,NO,256,Extension_2,,INFORMATICA,,varchar,,2,PRIMARY KEY,CNTRY_TYPE_CD,NOTNULL,,8,0,,,Teradata,,CNTRY_MULTI_DEF_CD_S,1,,2,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,date,,3,0,ELEMITEM,NO,PRIMARY KEY,19,0,DW_EFF_DT,NOTNULL,0,11,10,18,,10,0,,,Flat File,Flat_File,,cntry_multi_def_cd_daily,1,,2,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,Sort Specification,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,STRING,,User Defined Metadata Domain,YES,YES,NO,NO,NO,256,Extension_9,,INFORMATICA,,date,,3,PRIMARY KEY,DW_EFF_DT,NOTNULL,,10,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,date,,4,0,ELEMITEM,NO,NOT A KEY,19,0,DW_EXPR_DT,NOTNULL,0,30,10,28,,10,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,Datetime Format,A  19 mm/dd/yyyy hh24:mi:ss,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,date,,4,NOT A KEY,DW_EXPR_DT,NOTNULL,,10,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,byteint,,5,0,ELEMITEM,NO,NOT A KEY,4,0,CURR_IN,NOTNULL,0,49,3,38,,3,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,Thousand Separator,None,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,byteint,,5,NOT A KEY,CURR_IN,NOTNULL,,3,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,byteint,,6,0,ELEMITEM,NO,NOT A KEY,4,0,RCV_IN,NOTNULL,0,53,3,41,,3,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,Decimal Separator,.,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,byteint,,6,NOT A KEY,RCV_IN,NOTNULL,,3,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,varchar,,7,0,ELEMITEM,NO,NOT A KEY,0,0,CNTRY_CD,NOTNULL,0,57,8,44,,8,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,Add Currently Processed Flat File Name Port,NO,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,varchar,,7,NOT A KEY,CNTRY_CD,NOTNULL,,8,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,varchar,,8,0,ELEMITEM,NO,NOT A KEY,0,0,CNTRY_NM,NULL,0,57,60,52,,60,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,Source TimeStamp,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,varchar,,8,NOT A KEY,CNTRY_NM,NULL,,60,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,char,,9,0,ELEMITEM,NO,NOT A KEY,0,0,CNTRY_TYPE_VALID_IN,NULL,0,57,1,112,,1,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,char,,9,NOT A KEY,CNTRY_TYPE_VALID_IN,NULL,,1,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,char,,10,0,ELEMITEM,NO,NOT A KEY,0,0,AUDIT_UPDT_USER_ID,NULL,0,57,30,113,,30,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,char,,10,NOT A KEY,AUDIT_UPDT_USER_ID,NULL,,30,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,timestamp,,11,0,ELEMITEM,NO,NOT A KEY,19,0,AUDIT_UPDT_TS,NULL,0,57,19,143,,19,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,timestamp,,11,NOT A KEY,AUDIT_UPDT_TS,NULL,,19,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,timestamp,,12,0,ELEMITEM,NO,NOT A KEY,19,0,DW_LOAD_TS,NOTNULL,0,76,19,162,,19,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,timestamp,,12,NOT A KEY,DW_LOAD_TS,NOTNULL,,19,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,varchar,,2,0,ELEMITEM,NO,PRIMARY KEY,0,0,CNTRY_SCHEME_CD,NOTNULL,0,11,8,10,,8,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,varchar,,2,PRIMARY KEY,CNTRY_SCHEME_CD,NOTNULL,,8,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,date,,3,0,ELEMITEM,NO,NOT A KEY,19,0,DW_AS_OF_DT,NOTNULL,0,11,10,18,,10,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,date,,3,NOT A KEY,DW_AS_OF_DT,NOTNULL,,10,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,char,,4,0,ELEMITEM,NO,NOT A KEY,0,0,DW_ACTN_IND,NULL,0,30,1,28,,1,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,char,,4,NOT A KEY,DW_ACTN_IND,NULL,,1,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,varchar,,5,0,ELEMITEM,NO,NOT A KEY,0,0,CNTRY_CD,NOTNULL,0,30,8,29,,8,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,varchar,,5,NOT A KEY,CNTRY_CD,NOTNULL,,8,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,varchar,,6,0,ELEMITEM,NO,NOT A KEY,0,0,CNTRY_NM,NULL,0,30,60,37,,60,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,varchar,,6,NOT A KEY,CNTRY_NM,NULL,,60,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,char,,7,0,ELEMITEM,NO,NOT A KEY,0,0,CNTRY_SCHM_VALD_IN,NULL,0,30,1,97,,1,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,char,,7,NOT A KEY,CNTRY_SCHM_VALD_IN,NULL,,1,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,char,,8,0,ELEMITEM,NO,NOT A KEY,0,0,AUDIT_UPDT_USER_ID,NULL,0,30,30,98,,30,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,char,,8,NOT A KEY,AUDIT_UPDT_USER_ID,NULL,,30,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,timestamp,,9,0,ELEMITEM,NO,NOT A KEY,19,0,AUDIT_UPDT_TS,NULL,0,30,19,128,,19,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,timestamp,,9,NOT A KEY,AUDIT_UPDT_TS,NULL,,19,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,timestamp,,10,0,ELEMITEM,NO,NOT A KEY,19,0,DW_LOAD_TS,NOTNULL,0,49,19,147,,19,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,timestamp,,10,NOT A KEY,DW_LOAD_TS,NOTNULL,,19,0,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,string,,2,0,ELEMITEM,NO,NOT A KEY,1,0,CHANGE_IND,NULL,0,10,1,10,,1,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,number,,3,0,ELEMITEM,NO,NOT A KEY,10,0,SWB_CNTRY_ID,NOTNULL,0,11,10,11,,10,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,string,,4,0,ELEMITEM,NO,NOT A KEY,8,0,CNTRY_SCHEME_CD,NOTNULL,0,21,8,21,,8,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,string,,5,0,ELEMITEM,NO,NOT A KEY,1,0,CNTRY_SCHM_VALD_IN,NULL,0,29,1,29,,1,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,string,,6,0,ELEMITEM,NO,NOT A KEY,8,0,CNTRY_CD,NOTNULL,0,30,8,30,,8,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,string,,7,0,ELEMITEM,NO,NOT A KEY,60,0,CNTRY_NM,NULL,0,38,60,38,,60,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,string,,8,0,ELEMITEM,NO,NOT A KEY,30,0,AUDIT_UPDT_USER_ID,NULL,0,98,30,98,,30,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IDW_SHARE,,Administrator,SHARED,,rwx------,48f82822-936b-4bfc-af8e-2614f65fba60,,string,,9,0,ELEMITEM,NO,NOT A KEY,26,0,AUDIT_UPDT_TS,NULL,0,128,26,128,,26,0,,,,,,,,,,,integer,,1,0,ELEMITEM,NO,PRIMARY KEY,11,0,SWB_CNTRY_ID,NOTNULL,0,0,10,0,,10,0,,,,,string,,1,0,ELEMITEM,NO,NOT A KEY,10,0,OUTPUT_RUNDATE,NOTNULL,0,0,10,0,,10,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,integer,,1,PRIMARY KEY,SWB_CNTRY_ID,NOTNULL,,10,0
